<h2 ng-if="conversation.state.is('new')" class="border-bottom no-margin">
    <i class="fa cm-talk"></i>
    neuer Talk
</h2>
<h2 ng-if="!conversation.state.is('new') && conversation.subject" class="border-bottom no-margin">
    <i class="fa cm-talk"></i>
    <span ng-bind-html="conversation.subject|cmParse" data-qa="text-subject"></span>
</h2>
<section class="body-group recipients" ng-if="conversation.state.is('new') || !conversation.state.is('new') && conversation.recipients.length > 1">
    <h3 ng-click="toggleRecipientView()" cm-reactive>
        <i class="fa" ng-class="{'cm-grid':!showGrid,'cm-menu-weight':showGrid}"></i>
        {{'CONVERSATION.PLACEHOLDER.RECIPIENTS'|cmTranslate}}
        <span class="recipients-counter">({{conversation.recipients.length-1}})</span>
        <span class="recipient-name" ng-show="showGrid">{{recipientName}}</span>
    </h3>
    <div class="recipients-list">
        <div
            class="scroller"
            ng-class="{
                'show-scrollbar': conversation.recipients.length > 7 && showGrid,
                'disable-scrollbar': !showGrid
            }">
            <div
                class="add-new-recipients"
                ng-click="goto('conversation/'+(conversation.id||'new')+'/recipients')"
                cm-reactive
                ng-if="conversation.recipients.length == 1 && conversation.state.is('new')">
                <cm-avatar cm-view="unknown"></cm-avatar>
                <span>{{'CONVERSATION.PLACEHOLDER.ADD_RECIPIENTS'|cmTranslate}}</span>
            </div>
            <cm-avatar
                cm-data="recipient"
                ng-click="showName(recipient)"
                ng-class="{
                    'name-shown': recipientName == recipient.getDisplayName()
                }"
                ng-repeat="recipient in conversation.recipients|cmHideAppOwner|orderBy:'getDisplayName()':false"
                cm-first-of-repeat="showName(recipient)"
                ng-show="showGrid">
            </cm-avatar>
            <cm-recipients-comma-seperated cm-data="conversation" ng-show="!showGrid"></cm-recipients-comma-seperated>
        </div>
        <div
            class="cm-add-button"
            ng-click="goto('conversation/'+(conversation.id||'new')+'/recipients')"
            cm-reactive
            cm-user-rights>
            <i
                class="fa"
                ng-class="{
                    'cm-checkbox-add':conversation.recipients.length == 1,
                    'cm-list':conversation.recipients.length > 1
                }"></i>
        </div>
    </div>
</section>

<section class="body-group no-pad border-top" ng-if="conversation.state.is('new')">
    <article class="content cm-form-style mt5">
        <label>{{'CONVERSATION.PLACEHOLDER.SUBJECT' | cmTranslate}}</label>
        <div class="cm-input-ctn with-inside-icon">
            <input
                    type="text"
                    data-qa="input-subject"
                    ng-model="conversation.subject"
                    placeholder="{{'CONVERSATION.PLACEHOLDER.NO_SUBJECT'|cmTranslate}}"
                    cm-adaptive-change
                    />
            <i class="fa cm-write"></i>
        </div>
    </article>

    <div style="height:1rem"></div>
</section>

<button class="cm-btn-grey" ng-if="conversation && conversation.numberOfMessages > conversation.messages.length" ng-show="conversation.numberOfMessages != conversation.messages.length" ng-click="loadPreviousMessages()" data-qa="btn-load-more-messages">
    {{'CONVERSATION.LABEL.LOAD_PREVIOUS'|cmTranslate}}
</button>

<div id="conversation-top"></div>

<cm-messages-timeline></cm-messages-timeline>

<div id="conversation-bottom" cm-scroll-to="{anchor:'#conversation-bottom',force:'bottom',onEvent:true}"></div>

<cm-answer></cm-answer>