cm-message{
  &.file-view{
    article{
      color:@cm-white;
      .author span{
        color:@cm-light-grey;
      }
      div.message{
        padding-bottom:1.5em;
        &.left, &.right{
          background-color:@cm-overlay-dark;
        }
        &.left{
          padding-top:1.5rem;
          .text{
            span {
              margin-top: 0;
            }
          }
        }
      }
      span.nose{
        &.left, &.right{
          i {
            color: @cm-overlay-dark;
          }
        }
      }
    }
  }
}

cm-message-file{
  display:block;
  position:relative;
  min-height:@cm-unit;
  margin:0 auto;
  margin-bottom: 0.5em;
  text-align: center;

  .file-image{
    min-height:@cm-unit;
    position:relative;
    div[cm-spinner]{
      z-index:1;
      position:absolute;
      left:50%;
      top:50%;
    }
    img{
      display:block;
      max-width:@cm-message-min-width;
      min-height:@cm-unit * 2;
      margin:0 auto;
    }
  }
  .file{
    margin:0 auto;
  }
  &:last-child{
    margin-bottom:0;
  }
}

cm-files{
  display:block;
  position:relative;
  width:@cm-unit;
  height:@cm-unit;

  cm-file-choose{
    height:100%;
//    overflow:hidden;
    position:absolute;
    right:0;
    top:0;
    width:100%;

    input{
      .with-cursor;
      bottom:0;
      font-size:1000px !important;
      height:300px;
      margin:0;
      opacity:0;
      padding:0;
      position:absolute;
      right:0;
    }
  }
}

cm-files-preview{
  display:block;
  position:absolute;
  bottom:@cm-footer-height;
  width:@cm-app-width;
  background-color:rgba(255,255,255,0.9);

  .files-list{
    text-align:center;
    padding:@cm-vertical-padding;
  }

  .file-image{
    position:relative;
    height:@cm-unit * 2;
    margin:0 auto;

    div[cm-spinner]{
      z-index:1;
      position:absolute;
      left:50%;
      top:50%;
    }
    img{
      display:block;
      max-width:@cm-app-width - 1;
      max-height:@cm-unit * 2;
      margin:0 auto;
    }
  }
  .file{
    margin:0 auto;
  }
}

.file {
  display: inline-block;
  background:url(../gfx/filetype_map_small.png) transparent 0 -2340px;
  height:60px !important;
  width:60px !important;
  border:0;
  cursor:pointer;
  padding:0;
  vertical-align:text-bottom;
}
@files:dir dir-download dir-safe dir-public pdf txt xlsx doc php css xls zip rar sit jpg gif bmp tif eps png mov mpg mp4 flv avi xml html chm ttf exe dmg mp3 wav wma aif ogg '\33ggp' ppt pps unknown;
@filesnum:length(@files);
.spriteFiles(@index:0) when (@index < @filesnum){
  @name: extract(@files, @index + 1);
  @selector: ~".file.@{name}";

  .bg-pos(@y) when (@y < 1){background-position:0 0;}
  .bg-pos(@y) when (@y > 0){background-position:~`"0 -@{y}px"`;}

  @{selector} {.bg-pos(60 * @index)}
  // next item
  .spriteFiles(@index + 1);
}
.spriteFiles();
