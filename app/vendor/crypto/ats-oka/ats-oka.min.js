(function(b){b.atsOka=function a(){var m=this,z,s,o,w,f,C,y,c,e,u,g;function r(F){z=function(L,H){var J=H.split(".");var G=L;for(var I=0;I<J.length;I++){var K=J[I];if(G[K]==null){G[K]={}}G=G[K]}return G};s=function(M,H,I){var K=H.split(".");var G=M;for(var J=0;J<K.length;J++){var L=K[J];if(J<K.length-1){if(G[L]==null){G[L]={}}}else{if(G[L]==null){G[L]=I}else{throw"The specified package path is already defined. "+H}}G=G[L]}return G};o=function(N,H,I){var L=H.split(".");var G=N;var K="[package root]";for(var J=0;J<L.length;J++){var M=L[J];K+="."+M;if(G[M]==null){throw H+" is not found. "+K+" is null in "+y.unit_name+"."}G=G[M]}return G};C={};y="";w=function(G){C[G]=true;y={unit_name:G,requring_units:{}}};f=function(G){if(C[G]){y.requring_units[G]=true;return true}else{throw"Unit Not Found Error : "+y.unit_name+" requires "+G}};Object.prototype.resolve=function(G){return z(this,G)};F.__package=z;F.__import=o;F.__export=s;F.__unit=w;F.__uses=f;F.__DEFINED_UNITS=C;F.__PACKAGE_ENABLED=true;w("packages.js")}r(this);var j=this;if(j.__PACKAGE_ENABLED){w("isarray.js");f("packages.js")}Array.prototype.isArray=true;function k(aq){if(aq.__PACKAGE_ENABLED){w("binary.js")}var Y=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];function af(aN){var aF=aN.length;var aM=Math.floor(aF/3);var aG=aF-3*aM;var aO="";var aL=0;for(var aH=0;aH<aM;aH++){var aK=aN[aL++]&255;var aJ=aN[aL++]&255;var aI=aN[aL++]&255;aO+=(Y[aK>>2]);aO+=(Y[(aK<<4)&63|(aJ>>4)]);aO+=(Y[(aJ<<2)&63|(aI>>6)]);aO+=(Y[aI&63])}if(aG==0){}else{if(aG==1){var aK=aN[aL++]&255;aO+=(Y[aK>>2]);aO+=(Y[(aK<<4)&63]);aO+=("==")}else{if(aG==2){var aK=aN[aL++]&255;var aJ=aN[aL++]&255;aO+=(Y[aK>>2]);aO+=(Y[(aK<<4)&63|(aJ>>4)]);aO+=(Y[(aJ<<2)&63]);aO+=("=")}else{throw"never happen"}}}return aO}var U=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];function aD(aG){var aF=(0<=aG)&&(aG<U.length)?U[aG]:-1;if(aF<0){throw"Illegal character "+aG}return aF}function aa(aQ){var aF=aQ.length;var aP=Math.floor(aF/4);if(4*aP!=aF){throw"String length must be a multiple of four."}var aK=0;if(aF!=0){if(aQ.charAt(aF-1)=="="){aK++;aP--}if(aQ.charAt(aF-2)=="="){aK++}}var aN=(3*aP-aK);if(aN<0){aN=0}var aR=new Array(aN);var aM=0;var aO=0;for(var aJ=0;aJ<aP;aJ++){var aL=aD(aQ.charCodeAt(aM++));var aI=aD(aQ.charCodeAt(aM++));var aH=aD(aQ.charCodeAt(aM++));var aG=aD(aQ.charCodeAt(aM++));aR[aO++]=255&((aL<<2)|(aI>>4));aR[aO++]=255&((aI<<4)|(aH>>2));aR[aO++]=255&((aH<<6)|aG)}if(aK==0){}else{if(aK==1){var aL=aD(aQ.charCodeAt(aM++));var aI=aD(aQ.charCodeAt(aM++));var aH=aD(aQ.charCodeAt(aM++));aR[aO++]=255&((aL<<2)|(aI>>4));aR[aO++]=255&((aI<<4)|(aH>>2))}else{if(aK==2){var aL=aD(aQ.charCodeAt(aM++));var aI=aD(aQ.charCodeAt(aM++));aR[aO++]=255&((aL<<2)|(aI>>4))}else{throw"never happen"}}}return aR}function aj(aF){return ao(af(aF))}function ah(aF){return aa(am(aF))}var N={};N.x="xx";N["+"]="xa";N["/"]="xb";N["="]="";function ao(aH){var aG="";for(var aF=0;aF<aH.length;aF++){var aJ=aH.charAt(aF);var aI=N[aJ];if(aI!=null){aG=aG+aI}else{aG=aG+aJ}}return aG}var J={};J.x="x";J.a="+";J.b="/";function am(aH){var aG="";for(var aF=0;aF<aH.length;aF++){var aJ=aH.charAt(aF);if(aJ=="x"){aJ=aH.charAt(++aF);var aI=J[aJ];if(aI!=null){aG=aG+aI}else{}}else{aG=aG+aJ}}while(aG.length%4!=0){aG+="="}return aG}function ad(aG,aF){if(aG.length!=aF.length){return false}var aI=aG.length;for(var aH=0;aH<aI;aH++){if(aG[aH]!=aF[aH]){return false}}return true}function ap(aG){if(aG==null){return"??"}aG&=255;var aF=aG.toString(16);return(aF.length<2)?"0"+aF:aF}function aE(aG,aF,aH){return ai(aG,aF,aH)}function ai(aI,aH,aJ){if(aJ==null){aJ=""}if(aH==null){aH=256}var aF="";for(var aG=0;aG<aI.length;aG++){if((aG%aH==0)&&(0<aG)){aF+="\n"}aF+=ap(aI[aG])+aJ}return aF.toUpperCase()}var V={};V["0"]=0;V["1"]=1;V["2"]=2;V["3"]=3;V["4"]=4;V["5"]=5;V["6"]=6;V["7"]=7;V["8"]=8;V["9"]=9;V.A=10;V.B=11;V.C=12;V.D=13;V.E=14;V.F=15;V.a=10;V.b=11;V.c=12;V.d=13;V.e=14;V.f=15;function ab(aG){var aF=V[aG];if(aF==null){throw"found an invalid character."}return aF}function ae(aK){var aG=[];for(var aJ=0,aI=0;aJ<aK.length;aJ++){var aL=aK.charAt(aJ);if(aL=="s"){continue}else{aG[aI++]=aL}}if(aG.length%2!=0){throw"data must be a multiple of two."}var aF=new Array(aG.length>>1);for(var aJ=0;aJ<aG.length;aJ+=2){var aH=255&((ab(aG[aJ])<<4)|(ab(aG[aJ+1])));aF[aJ>>1]=aH}return aF}var al=128;var an=192;var O=224;var aB=240;var T=248;var Q=252;var ay=254;var ax=127;var aw=63;var S=31;var ac=15;var K=7;var R=3;var ag=1;function L(aJ){var aG=[];var aI=aJ.length;var aF=0;for(var aH=0;aH<aI;aH++){var aK=aJ.charCodeAt(aH);if(aK<=127){aG[aF++]=aK}else{if(aK<=2047){aG[aF++]=an|(S&(aK>>>6));aG[aF++]=al|(aw&(aK>>>0))}else{if(aK<=65535){aG[aF++]=O|(ac&(aK>>>12));aG[aF++]=al|(aw&(aK>>>6));aG[aF++]=al|(aw&(aK>>>0))}else{if(aK<=1114111){aG[aF++]=aB|(K&(aK>>>18));aG[aF++]=al|(aw&(aK>>>12));aG[aF++]=al|(aw&(aK>>>6));aG[aF++]=al|(aw&(aK>>>0))}else{throw"error"}}}}}return aG}function aA(aI){var aF="";var aH=aI.length;for(var aG=0;aG<aH;){var aJ=aI[aG++];if(aJ<128){aF+=String.fromCharCode(aJ)}else{if((aJ<O)){aF+=String.fromCharCode(((S&aJ)<<6)|((aw&aI[aG++])<<0))}else{if((aJ<aB)){aF+=String.fromCharCode(((ac&aJ)<<12)|((aw&aI[aG++])<<6)|((aw&aI[aG++])<<0))}else{if((aJ<T)){aF+=String.fromCharCode(((K&aJ)<<18)|((aw&aI[aG++])<<12)|((aw&aI[aG++])<<6)|((aw&aI[aG++])<<0))}else{if((aJ<Q)){aF+=String.fromCharCode(((R&aJ)<<24)|((aw&aI[aG++])<<18)|((aw&aI[aG++])<<12)|((aw&aI[aG++])<<6)|((aw&aI[aG++])<<0))}else{if((aJ<ay)){aF+=String.fromCharCode(((ag&aJ)<<30)|((aw&aI[aG++])<<24)|((aw&aI[aG++])<<18)|((aw&aI[aG++])<<12)|((aw&aI[aG++])<<6)|((aw&aI[aG++])<<0))}}}}}}}return aF}function G(aG){var aF="";for(var aH=0;aH<aG.length;aH++){aF+=String.fromCharCode(aG[aH])}return aF}function M(aH){var aF=new Array(aH.length);for(var aG=0;aG<aH.length;aG++){aF[aG]=aH.charCodeAt(aG)}return aF}function H(aF){return[255&(aF>>24),255&(aF>>16),255&(aF>>8),255&(aF>>0)]}function ak(aF){return((aF[0]<<24)|(aF[1]<<16)|(aF[2]<<8)|(aF[3]<<0))}function I(aF){return[255&(aF>>8),255&(aF>>0)]}function au(aF){return(0|(aF[0]<<8)|(aF[1]<<0))}function at(aF){return[255&(aF>>0),255&(aF>>8),255&(aF>>16),255&(aF>>24)]}function W(aF){return(0|(aF[3]<<0)|(aF[2]<<8)|(aF[1]<<16)|(aF[0]<<24))}function av(aF){return[255&(aF>>0),255&(aF>>8)]}function Z(aF){return(0|(aF[1]<<0)|(aF[0]<<8))}function P(aG){var aI=aG.length<<2;var aJ=new Array(aI);for(var aH=0,aF=0;aH<aG.length&&aF<aJ.length;){aJ[aF++]=255&(aG[aH]>>24);aJ[aF++]=255&(aG[aH]>>16);aJ[aF++]=255&(aG[aH]>>8);aJ[aF++]=255&(aG[aH]>>0);aH++}return aJ}function ar(aJ){var aI=(aJ.length+3)>>2;var aG=new Array(aI);for(var aH=0,aF=0;aH<aG.length&&aF<aJ.length;){aG[aH++]=(aF<aJ.length?(aJ[aF++]<<24):0)|(aF<aJ.length?(aJ[aF++]<<16):0)|(aF<aJ.length?(aJ[aF++]<<8):0)|(aF<aJ.length?(aJ[aF++]):0)}return aG}function aC(aG){var aI=aG.length<<2;var aJ=new Array(aI);for(var aH=0,aF=0;aH<aG.length&&aF<aJ.length;){aJ[aF++]=255&(aG[aH]>>0);aJ[aF++]=255&(aG[aH]>>8);aJ[aF++]=255&(aG[aH]>>16);aJ[aF++]=255&(aG[aH]>>24);aH++}return aJ}function X(aJ){var aI=(aJ.length+3)>>2;var aG=new Array(aI);for(var aH=0,aF=0;aH<aG.length&&aF<aJ.length;){aG[aH++]=(aF<aJ.length?(aJ[aF++]):0)|(aF<aJ.length?(aJ[aF++]<<8):0)|(aF<aJ.length?(aJ[aF++]<<16):0)|(aF<aJ.length?(aJ[aF++]<<24):0)}return aG}function F(aH){var aG="";for(var aF=0;aF<aH.length;aF++){var aI=aH.charAt(aF);if(aI=="s"||aI=="\t"||aI=="\r"||aI=="\n"){}else{aG+=aI}}return aG}function az(aF,aG){return function(aM,aO,aP){var aH=true;for(var aK=0;aK<aM;aK++){for(var aJ=aO;aJ<aP;aJ++){var aL=new Array(aJ);for(var aI=0;aI<aJ;aI++){aL[aI]=Math.floor(Math.random()*256)}var aQ=aF(aL);var aN=aG(aQ);trace("in :"+aL.length+":"+ai(aL));trace("b64:"+aQ.length+":"+aQ);trace("out:"+aN.length+":"+ai(aL));if(ad(aL,aN)){trace("OK! ( "+aK+","+aJ+")")}else{trace("ERR ( "+aK+","+aJ+")");aH=false}trace("-----------")}}if(aH){trace("ALL OK! ")}else{trace("FOUND ERROR!")}}}aq.base64_encode=af;aq.base64_decode=aa;aq.base64_test=az(af,aa);aq.base64x_encode=aj;aq.base64x_decode=ah;aq.base64x_test=az(aj,ah);aq.base64x_pre_encode=ao;aq.base64x_pre_decode=am;aq.base16_encode=ai;aq.base16_decode=ae;aq.base16=aE;aq.hex=aE;aq.utf82str=aA;aq.str2utf8=L;aq.str2char=M;aq.char2str=G;aq.i2ba=H;aq.ba2i=ak;aq.i2ba_be=H;aq.ba2i_be=ak;aq.i2ba_le=at;aq.ba2i_le=W;aq.s2ba=I;aq.ba2s=au;aq.s2ba_be=I;aq.ba2s_be=au;aq.s2ba_le=av;aq.ba2s_le=Z;aq.ba2ia=ar;aq.ia2ba=P;aq.ia2ba_be=P;aq.ba2ia_be=ar;aq.ia2ba_le=aC;aq.ba2ia_le=X;aq.cmparr=ad}k(this);function p(G){var F=function(H){if(G.__PACKAGE_ENABLED){w("elapse.js")}if(H==null){H="ElapsedTime"}return{n:H,s:0,e:0,now:function(){return new Date().getTime()},start:function(I){if(I!=null){this.n=I}this.s=this.now()},stop:function(){this.e=this.now();c.get_db(this.n).push(this.get())},print:function(){trace(this.name()+" : "+(this.get()/1000))},name:function(){return this.n},get:function(){return this.e-this.s}}};c=F();c.db={};c.db.prototype=null;c.get_db=function(I){var H=this.db[I];if(H==null){H=[];this.db[I]=H}return H};c.display=function(J){if(J==null){var L=[];var H=[];var K=0;for(var M in this.db){if(L[M]===undefined){H[K++]=M}}H.sort();for(var K=0;K<H.length;K++){c.display(H[K])}}else{var H=c.get_db(J);var I=0;for(var K=0;K<H.length;K++){I+=H[K]}trace("ElapsedTime("+J+" ): "+I+"/"+H.length+" AVG="+(I/H.length/1000))}};c.create=F;G.ElapsedTime=c}p(this);function l(J){w("BigInteger.init1.js");f("packages.js");var M=function(S){var N=function(X,T,U,W,Z,Y){while(--Y>=0){var V=T*this[X++]+U[W]+Z;Z=Math.floor(V/67108864);U[W++]=V&67108863}return Z};var R=function(X,ac,ad,W,aa,T){var Z=ac&32767,ab=ac>>15;while(--T>=0){var V=this[X]&32767;var Y=this[X++]>>15;var U=ab*V+Y*Z;V=Z*V+((U&32767)<<15)+ad[W]+(aa&1073741823);aa=(V>>>30)+(U>>>15)+ab*Y+(aa>>>30);ad[W++]=V&1073741823}return aa};var Q=function(X,ac,ad,W,aa,T){var Z=ac&16383,ab=ac>>14;while(--T>=0){var V=this[X]&16383;var Y=this[X++]>>14;var U=ab*V+Y*Z;V=Z*V+((U&16383)<<14)+ad[W]+aa;aa=(V>>28)+(U>>14)+ab*Y;ad[W++]=V&268435455}return aa};var P=244837814094590;var O=((P&16777215)==15715070);if(true){S.prototype.am=R;S.dbits=30;S.log("AM_INIT MODIFICATION SUCCEEDED.")}else{if(O&&(navigator.appName=="Microsoft Internet Explorer")){S.prototype.am=R;S.dbits=30}else{if(O&&(navigator.appName!="Netscape")){S.prototype.am=N;S.dbits=26}else{S.prototype.am=Q;S.dbits=28}}}S.BI_FP=52;S.DB=S.dbits;S.DM=(1<<S.DB)-1;S.DV=(1<<S.DB);S.FV=Math.pow(2,S.BI_FP);S.F1=S.BI_FP-S.DB;S.F2=2*S.DB-S.BI_FP};var H=function(N){this.m=N;this.convert=function(O){if(O.s<0||O.compareTo(this.m)>=0){return O.mod(this.m)}else{return O}}};H.prototype.revert=function(N){return N};H.prototype.reduce=function(N){N.divRemTo(this.m,null,N)};H.prototype.mulTo=function(N,P,O){N.multiplyTo(P,O);this.reduce(O)};H.prototype.sqrTo=function(N,O){N.squareTo(O);this.reduce(O)};H.prototype.toString=function(){return"Classic()"};var I=function(N){this.m=N;this.mp=N.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(L.DB-15))-1;this.mt2=2*N.t};I.prototype.convert=function(N){var O=new L();N.abs().dlShiftTo(this.m.t,O);O.divRemTo(this.m,null,O);if(N.s<0&&O.compareTo(L.ZERO)>0){this.m.subTo(O,O)}return O};I.prototype.revert=function(N){var O=new L();N.copyTo(O);this.reduce(O);return O};I.prototype.reduce=function(N){while(N.t<=this.mt2){N[N.t++]=0}for(var P=0;P<this.m.t;++P){var O=N[P]&32767;var Q=(O*this.mpl+(((O*this.mph+(N[P]>>15)*this.mpl)&this.um)<<15))&L.DM;O=P+this.m.t;N[O]+=this.m.am(0,Q,N,P,0,this.m.t);while(N[O]>=L.DV){N[O]-=L.DV;O++;N[O]++}}N.clamp();N.drShiftTo(this.m.t,N);if(N.compareTo(this.m)>=0){N.subTo(this.m,N)}};I.prototype.sqrTo=function(N,O){N.squareTo(O);this.reduce(O)};I.prototype.mulTo=function(N,P,O){N.multiplyTo(P,O);this.reduce(O)};I.prototype.toString=function(){return"Montgomery()"};var L=function(){if(arguments.length==0){}else{if(arguments.length==1){var S=arguments[0];var P=typeof S;if("number"==P){if((-1*L.DV<=S)&&(S<L.DV)){this.fromInt(S)}else{this.fromString(S.toString(16),16)}}else{if("string"==P){this.fromString(S,10)}else{this.fromByteArray(S)}}}else{if(arguments.length==2){var S=arguments[0];var P=typeof S;var R=arguments[1];var O=typeof R;if("number"==P){this.fromNumber2(S,R)}else{if("string"==P){this.fromString(S,R)}else{throw"parameter(1) must be either a number or a string. "+P}}}else{if(arguments.length==3){var S=arguments[0];var P=typeof S;var R=arguments[1];var O=typeof R;var Q=arguments[2];var N=typeof Q;if("number"==P){this.fromNumber1(S,R,Q)}else{throw"parameter(1) must be a number. "+P}}}}}};L.prototype.className="BigInteger";var F=new Array();var K=function(){var N,O;N="0".charCodeAt(0);for(O=0;O<=9;++O){F[N++]=O}N="a".charCodeAt(0);for(O=10;O<36;++O){F[N++]=O}N="A".charCodeAt(0);for(O=10;O<36;++O){F[N++]=O}};K();L.intAt=function(O,N){var P=F[O.charCodeAt(N)];return(P==null)?-1:P};var G="0123456789abcdefghijklmnopqrstuvwxyz";L.int2char=function(N){return G.charAt(N)};L.nbits=function(N){var P=1,O;if((O=N>>>16)!=0){N=O;P+=16}if((O=N>>8)!=0){N=O;P+=8}if((O=N>>4)!=0){N=O;P+=4}if((O=N>>2)!=0){N=O;P+=2}if((O=N>>1)!=0){N=O;P+=1}return P};L.prototype.copyTo=function(O){for(var N=this.t-1;N>=0;--N){O[N]=this[N]}O.t=this.t;O.s=this.s};L.prototype.fromInt=function(N){this.t=1;this.s=(N<0)?-1:0;if(N>0){this[0]=N}else{if(N<-1){this[0]=N+L.DV}else{this.t=0}}};L.prototype.fromString=function(T,O){var Q;if(O<=0){throw"bitLength must be larger than 0"}else{if(O==2){Q=1}else{if(O==4){Q=2}else{if(O==8){Q=3}else{if(O==16){Q=4}else{if(O==32){Q=5}else{if(O==256){Q=8}else{this.fromRadix(T,O);return}}}}}}}this.t=0;this.s=0;var S=T.length;var P=false;var R=0;while(--S>=0){var N=(Q==8)?T[S]&255:L.intAt(T,S);if(N<0){if(T.charAt(S)=="-"){P=true}continue}P=false;if(R==0){this[this.t++]=N}else{if(R+Q>L.DB){this[this.t-1]|=(N&((1<<(L.DB-R))-1))<<R;this[this.t]=(N>>(L.DB-R));this.t++}else{this[this.t-1]|=N<<R}}R+=Q;if(R>=L.DB){R-=L.DB}}if(Q==8&&(T[0]&128)!=0){this.s=-1;if(R>0){this[this.t-1]|=((1<<(L.DB-R))-1)<<R}}this.clamp();if(P){L.ZERO.subTo(this,this)}};L.prototype.fromByteArray=function(N){return this.fromString(N,256)};L.prototype.clamp=function(){var N=this.s&L.DM;while(this.t>0&&this[this.t-1]==N){--this.t}};L.prototype.toString=function(O){if(this.s<0){return"-"+this.negate().toString(O)}var P;if(O==16){P=4}else{if(O==8){P=3}else{if(O==2){P=1}else{if(O==32){P=5}else{if(O==4){P=2}else{return this.toRadix(O)}}}}}var R=(1<<P)-1,U,N=false,S="",Q=this.t;var T=L.DB-(Q*L.DB)%P;if(Q-->0){if(T<L.DB&&(U=this[Q]>>T)>0){N=true;S=L.int2char(U)}while(Q>=0){if(T<P){U=(this[Q]&((1<<T)-1))<<(P-T);U|=this[--Q]>>(T+=L.DB-P)}else{U=(this[Q]>>(T-=P))&R;if(T<=0){T+=L.DB;--Q}}if(U>0){N=true}if(N){S+=L.int2char(U)}}}return N?S:"0"};L.prototype.negate=function(){var N=new L();L.ZERO.subTo(this,N);return N};L.prototype.abs=function(){return(this.s<0)?this.negate():this};L.prototype.compareTo=function(N){var P=this.s-N.s;if(P!=0){return P}var O=this.t;P=O-N.t;if(P!=0){return P}while(--O>=0){if((P=this[O]-N[O])!=0){return P}}return 0};L.prototype.bitLength=function(){if(this.t<=0){return 0}return L.DB*(this.t-1)+L.nbits(this[this.t-1]^(this.s&L.DM))};L.prototype.dlShiftTo=function(P,O){var N;for(N=this.t-1;N>=0;--N){O[N+P]=this[N]}for(N=P-1;N>=0;--N){O[N]=0}O.t=this.t+P;O.s=this.s};L.prototype.drShiftTo=function(P,O){for(var N=P;N<this.t;++N){O[N-P]=this[N]}O.t=Math.max(this.t-P,0);O.s=this.s};L.prototype.lShiftTo=function(U,Q){var O=U%L.DB;var N=L.DB-O;var S=(1<<N)-1;var R=Math.floor(U/L.DB),T=(this.s<<O)&L.DM,P;for(P=this.t-1;P>=0;--P){Q[P+R+1]=(this[P]>>N)|T;T=(this[P]&S)<<O}for(P=R-1;P>=0;--P){Q[P]=0}Q[R]=T;Q.t=this.t+R+1;Q.s=this.s;Q.clamp()};L.prototype.rShiftTo=function(T,Q){Q.s=this.s;var R=Math.floor(T/L.DB);if(R>=this.t){Q.t=0;return}var O=T%L.DB;var N=L.DB-O;var S=(1<<O)-1;Q[0]=this[R]>>O;for(var P=R+1;P<this.t;++P){Q[P-R-1]|=(this[P]&S)<<N;Q[P-R]=this[P]>>O}if(O>0){Q[this.t-R-1]|=(this.s&S)<<N}Q.t=this.t-R;Q.clamp()};L.prototype.subTo=function(O,Q){var P=0,R=0,N=Math.min(O.t,this.t);while(P<N){R+=this[P]-O[P];Q[P++]=R&L.DM;R>>=L.DB}if(O.t<this.t){R-=O.s;while(P<this.t){R+=this[P];Q[P++]=R&L.DM;R>>=L.DB}R+=this.s}else{R+=this.s;while(P<O.t){R-=O[P];Q[P++]=R&L.DM;R>>=L.DB}R-=O.s}Q.s=(R<0)?-1:0;if(R<-1){Q[P++]=L.DV+R}else{if(R>0){Q[P++]=R}}Q.t=P;Q.clamp()};L.prototype.multiplyTo=function(O,Q){var N=this.abs(),R=O.abs();var P=N.t;Q.t=P+R.t;while(--P>=0){Q[P]=0}for(P=0;P<R.t;++P){Q[P+N.t]=N.am(0,R[P],Q,P,0,N.t)}Q.s=0;Q.clamp();if(this.s!=O.s){L.ZERO.subTo(Q,Q)}};L.prototype.squareTo=function(P){var N=this.abs();var O=P.t=2*N.t;while(--O>=0){P[O]=0}for(O=0;O<N.t-1;++O){var Q=N.am(O,N[O],P,2*O,0,1);if((P[O+N.t]+=N.am(O+1,2*N[O],P,2*O+1,Q,N.t-O-1))>=L.DV){P[O+N.t]-=L.DV;P[O+N.t+1]=1}}if(P.t>0){P[P.t-1]+=N.am(O,N[O],P,2*O,0,1)}P.s=0;P.clamp()};L.prototype.divRemTo=function(W,T,S){var ac=W.abs();if(ac.t<=0){return}var U=this.abs();if(U.t<ac.t){if(T!=null){T.fromInt(0)}if(S!=null){this.copyTo(S)}return}if(S==null){S=new L()}var Q=new L(),N=this.s,V=W.s;var ab=L.DB-L.nbits(ac[ac.t-1]);if(ab>0){ac.lShiftTo(ab,Q);U.lShiftTo(ab,S)}else{ac.copyTo(Q);U.copyTo(S)}var Y=Q.t;var O=Q[Y-1];if(O==0){return}var X=O*(1<<L.F1)+((Y>1)?Q[Y-2]>>L.F2:0);var af=L.FV/X,ae=(1<<L.F1)/X,ad=1<<L.F2;var aa=S.t,Z=aa-Y,R=(T==null)?new L():T;Q.dlShiftTo(Z,R);if(S.compareTo(R)>=0){S[S.t++]=1;S.subTo(R,S)}L.ONE.dlShiftTo(Y,R);R.subTo(Q,Q);while(Q.t<Y){Q[Q.t++]=0}while(--Z>=0){var P=(S[--aa]==O)?L.DM:Math.floor(S[aa]*af+(S[aa-1]+ad)*ae);if((S[aa]+=Q.am(0,P,S,Z,0,Y))<P){Q.dlShiftTo(Z,R);S.subTo(R,S);while(S[aa]<--P){S.subTo(R,S)}}}if(T!=null){S.drShiftTo(Y,T);if(N!=V){L.ZERO.subTo(T,T)}}S.t=Y;S.clamp();if(ab>0){S.rShiftTo(ab,S)}if(N<0){L.ZERO.subTo(S,S)}};L.prototype.mod=function(N){var O=new L();this.abs().divRemTo(N,null,O);if(this.s<0&&O.compareTo(L.ZERO)>0){N.subTo(O,O)}return O};L.prototype.invDigit=function(){if(this.t<1){return 0}var N=this[0];if((N&1)==0){return 0}var O=N&3;O=(O*(2-(N&15)*O))&15;O=(O*(2-(N&255)*O))&255;O=(O*(2-(((N&65535)*O)&65535)))&65535;O=(O*(2-N*O%L.DV))%L.DV;return(O>0)?L.DV-O:-O};L.prototype.isEven=function(){return((this.t>0)?(this[0]&1):this.s)==0};L.prototype.exp=function(S,T){if(S>4294967295||S<1){return L.ONE}var R=new L(),N=new L(),Q=T.convert(this),P=L.nbits(S)-1;Q.copyTo(R);while(--P>=0){T.sqrTo(R,N);if((S&(1<<P))>0){T.mulTo(N,Q,R)}else{var O=R;R=N;N=O}}return T.revert(R)};L.prototype.modPowInt=function(O,N){var P;if(O<256||N.isEven()){P=new L.Classic(N)}else{P=new L.Montgomery(N)}return this.exp(O,P)};L.log=function(N){return};L.err=function(N){trace(N);return};L.ZERO=new L(0);L.ONE=new L(1);M(L);L.Classic=H;L.Montgomery=I;s(J,"titaniumcore.crypto.BigInteger",L)}l(this);function D(I){w("RSA.init1.js");f("packages.js");f("BigInteger.init1.js");f("isarray.js");var K=o(I,"titaniumcore.crypto.BigInteger");var G=function(L){return L};var F=function(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null;this.ksize=0;this.tolerantlyGenerate=true;this.preprocessPublic=G;this.preprocessPrivate=G;this.keyFormat=F.defaultKeyFormat;this.messageFormat=F.defaultMessageFormat};F.prototype.className="RSA";F.prototype.toString=function(N){if(N==null){N=16}var M=this;var L="n="+(M.n==null?"":M.n.toString(N)+"("+this.n.bitLength()+")")+"\ne="+(M.e==null?"":M.e.toString(N))+"\nd="+(M.d==null?"":M.d.toString(N)+"("+this.d.bitLength()+")")+"\np="+(M.p==null?"":M.p.toString(N))+"\nq="+(M.q==null?"":M.q.toString(N))+"\ndmp1="+(M.dmp1==null?"":M.dmp1.toString(N))+"\ndmq1="+(M.dmq1==null?"":M.dmq1.toString(N))+"\ncoeff="+(M.coeff==null?"":M.coeff.toString(N))+"\n";return L};F.defaultKeyFormat=null;F.installKeyFormat=function(L){F.defaultKeyFormat=L};F.defaultMessageFormat=null;F.installMessageFormat=function(L){F.defaultMessageFormat=L};function J(L){return function(){if(arguments.length==0){return this[L]}else{var N=arguments[0];var M=typeof N;if(N==null){throw"parameter "+L+" cannot be null."}else{if(M=="object"&&N.className=="BigInteger"){this[L]=N}else{if(M=="object"&&N.isArray){this[L]=new K(N)}else{if(M=="string"){this[L]=new K(N,16)}else{if(M=="number"){this[L]=new K(N)}else{throw"parameter "+L+" must be a BigInteger object or a hex string or a number object."}}}}}return this}}}function H(L){return function(){if(arguments.length==0){return this[L]}else{var N=arguments[0];var M=typeof N;if(N==null){throw"parameter "+L+" cannot be null."}else{if(M=="object"&&N.className=="BigInteger"){this[L]=N.intValue()}else{if(M=="object"&&N.isArray){this[L]=new K(N).intValue()}else{if(M=="string"){this[L]=parseInt(N,16)}else{if(M=="number"){this[L]=N}else{throw"parameter "+L+" must be a BigInteger object or a hex string or a number object."}}}}}return this}}}F.prototype._n=J("n");F.prototype._e=H("e");F.prototype._d=J("d");F.prototype._p=J("p");F.prototype._q=J("q");F.prototype._dmp1=J("dmp1");F.prototype._dmq1=J("dmq1");F.prototype._coeff=J("coeff");F.prototype._ksize=H("ksize");F.prototype.publicKey=function(N,M,L){if(arguments.length==0){return{n:this.n,e:this.e,ksize:this.ksize}}else{this._n(N);this._e(M);this._ksize(L)}};F.prototype.processPublic=function(L){L=this.preprocessPublic(L);return L.modPowInt(this.e,this.n)};F.prototype.publicEncrypt=function(L){if(this.messageFormat==null){throw"Error. No message format is installed."}return this.messageFormat.publicEncrypt(this,L)};F.prototype.publicDecrypt=function(L){if(this.messageFormat==null){throw"Error. No message format is installed."}return this.messageFormat.publicDecrypt(this,L)};F.prototype.publicEncryptMaxSize=function(){if(this.messageFormat==null){throw"Error. No message format is installed."}return this.messageFormat.publicEncryptMaxSize(this)};F.prototype.publicKeyBytes=function(){if(this.keyFormat==null){throw"Error. No key format is installed."}if(arguments.length==0){if(this.ksize==null||this.ksize==0){throw"key size is not set."}return this.keyFormat.encodePublicKey(this.n,this.e,this.ksize)}else{var L=this.keyFormat.decodePublicKey(arguments[0]);this.publicKey(L.n,L.e,L.ksize);return this}};F.log=function(L){};F.err=function(L){trace(L)};s(I,"titaniumcore.crypto.RSA",F)}D(this);function v(J){w("SecureRandom.js");f("packages.js");var G=function(){this.i=0;this.j=0;this.S=new Array()};G.prototype.init=function(P){var O,M,N;for(O=0;O<256;++O){this.S[O]=O}M=0;for(O=0;O<256;++O){M=(M+this.S[O]+P[O%P.length])&255;N=this.S[O];this.S[O]=this.S[M];this.S[M]=N}this.i=0;this.j=0};G.prototype.next=function(){var M;this.i=(this.i+1)&255;this.j=(this.j+this.S[this.i])&255;M=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=M;return this.S[(M+this.S[this.i])&255]};G.create=function(){return new G()};G.rng_psize=256;var L=null;var I=[];var H=0;e=function(M){I[H]^=M&255;H++;I[H]^=(M>>8)&255;H++;I[H]^=(M>>16)&255;H++;I[H]^=(M>>24)&255;H++;if(H>=G.rng_psize){H-=G.rng_psize}};u=function(){e(new Date().getTime())};g=function(){var M;if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&b.crypto){var N=b.crypto.random(32);for(M=0;M<N.length;++M){I[H++]=N.charCodeAt(M)&255}}while(H<G.rng_psize){M=Math.floor(65536*Math.random());I[H++]=M>>>8;I[H++]=M&255}H=0;u()};var K=function(){if(L==null){u();L=G.create();L.init(I);for(H=0;H<I.length;++H){I[H]=0}H=0}return L.next()};var F=function(){};F.prototype.nextBytes=function(N){for(var M=0;M<N.length;++M){N[M]=K()}};g();s(J,"titaniumcore.crypto.SecureRandom",F)}v(this);function i(I){w("BigInteger.init2.js");f("packages.js");f("BigInteger.init1.js");var L=o(I,"titaniumcore.crypto.BigInteger");L.prototype.clone=function(){var M=new L();this.copyTo(M);return M};L.prototype.intValue=function(){if(this.s<0){if(this.t==1){return this[0]-L.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-L.DB))-1))<<L.DB)|this[0]};L.prototype.byteValue=function(){return(this.t==0)?this.s:(this[0]<<24)>>24};L.prototype.shortValue=function(){return(this.t==0)?this.s:(this[0]<<16)>>16};L.prototype.chunkSize=function(M){return Math.floor(Math.LN2*L.DB/Math.log(M))};L.prototype.signum=function(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}};L.prototype.toRadix=function(M){if(M==null){M=10}if(this.signum()==0||M<2||M>36){return"0"}var O=this.chunkSize(M);var N=Math.pow(M,O);var R=new L(N),S=new L(),Q=new L(),P="";this.divRemTo(R,S,Q);while(S.signum()>0){P=(N+Q.intValue()).toString(M).substr(1)+P;S.divRemTo(R,S,Q)}return Q.intValue().toString(M)+P};L.prototype.fromRadix=function(U,R){this.fromInt(0);if(R==null){R=10}var P=this.chunkSize(R);var Q=Math.pow(R,P);var O=false;var M=0;var T=0;for(var N=0;N<U.length;++N){var S=L.intAt(U,N);if(S<0){if(U.charAt(N)=="-"&&this.signum()==0){O=true}continue}T=R*T+S;if(++M>=P){this.dMultiply(Q);this.dAddOffset(T,0);M=0;T=0}}if(M>0){this.dMultiply(Math.pow(R,M));this.dAddOffset(T,0)}if(O){L.ZERO.subTo(this,this)}};var K=0;L.prototype.fromNumber1=function(N,O,M){var Q=c.create();Q.start("fromNumber1");if(N<2){this.fromInt(1)}else{this.fromNumber2(N,M);if(!this.testBit(N-1)){this.bitwiseTo(L.ONE.shiftLeft(N-1),L.op_or,this)}if(this.isEven()){this.dAddOffset(1,0)}var P=c.create();P.start("fromNumber1.loop");while(!this.isProbablePrime(O)){this.dAddOffset(2,0);if(this.bitLength()>N){this.subTo(L.ONE.shiftLeft(N-1),this)}}P.stop()}Q.stop()};L.prototype.fromNumber2=function(P,O){var Q=c.create();Q.start("fromNumber2");var M=new Array();var N=P&7;M.length=(P>>3)+1;O.nextBytes(M);if(N>0){M[0]&=((1<<N)-1)}else{M[0]=0}this.fromString(M,256);Q.stop()};L.prototype.toByteArray=function(){var O=this.t;var P=new Array();P[0]=this.s;var Q=L.DB-(O*L.DB)%8;var R;var N=0;if(O-->0){if(Q<L.DB&&(R=this[O]>>Q)!=(this.s&L.DM)>>Q){P[N++]=R|(this.s<<(L.DB-Q))}while(O>=0){if(Q<8){R=(this[O]&((1<<Q)-1))<<(8-Q);R|=this[--O]>>(Q+=L.DB-8)}else{R=(this[O]>>(Q-=8))&255;if(Q<=0){Q+=L.DB;--O}}if((R&128)!=0){R|=-256}if(N==0&&(this.s&128)!=(R&128)){++N}if(N>0||R!=this.s){P[N++]=R}}}for(var M=0;M<P.length;M++){P[M]=255&P[M]}return P};L.prototype.equals=function(M){return(this.compareTo(M)==0)};L.prototype.min=function(M){return(this.compareTo(M)<0)?this:M};L.prototype.max=function(M){return(this.compareTo(M)>0)?this:M};L.prototype.bitwiseTo=function(N,R,P){var O,Q,M=Math.min(N.t,this.t);for(O=0;O<M;++O){P[O]=R(this[O],N[O])}if(N.t<this.t){Q=N.s&L.DM;for(O=M;O<this.t;++O){P[O]=R(this[O],Q)}P.t=this.t}else{Q=this.s&L.DM;for(O=M;O<N.t;++O){P[O]=R(Q,N[O])}P.t=N.t}P.s=R(this.s,N.s);P.clamp()};L.op_and=function(M,N){return M&N};L.prototype.ope_and=function(M){var N=new L();this.bitwiseTo(M,L.op_and,N);return N};L.prototype.and=L.prototype.ope_and;L.op_or=function(M,N){return M|N};L.prototype.ope_or=function(M){var N=new L();this.bitwiseTo(M,L.op_or,N);return N};L.prototype.or=L.prototype.ope_or;L.op_xor=function(M,N){return M^N};L.prototype.ope_xor=function(M){var N=new L();this.bitwiseTo(M,L.op_xor,N);return N};L.prototype.xor=L.prototype.ope_xor;L.op_andnot=function(M,N){return M&~N};L.prototype.ope_andNot=function(M){var N=new L();this.bitwiseTo(M,L.op_andnot,N);return N};L.prototype.andNot=L.prototype.ope_andNot;L.prototype.ope_not=function(){var N=new L();for(var M=0;M<this.t;++M){N[M]=L.DM&~this[M]}N.t=this.t;N.s=~this.s;return N};L.prototype.not=L.prototype.ope_not;L.prototype.shiftLeft=function(N){var M=new L();if(N<0){this.rShiftTo(-N,M)}else{this.lShiftTo(N,M)}return M};L.prototype.shiftRight=function(N){var M=new L();if(N<0){this.lShiftTo(-N,M)}else{this.rShiftTo(N,M)}return M};L.lbit=function(M){if(M==0){return -1}var N=0;if((M&65535)==0){M>>=16;N+=16}if((M&255)==0){M>>=8;N+=8}if((M&15)==0){M>>=4;N+=4}if((M&3)==0){M>>=2;N+=2}if((M&1)==0){++N}return N};L.prototype.getLowestSetBit=function(){for(var M=0;M<this.t;++M){if(this[M]!=0){return M*L.DB+L.lbit(this[M])}}if(this.s<0){return this.t*L.DB}return -1};L.cbit=function(M){var N=0;while(M!=0){M&=M-1;++N}return N};L.prototype.bitCount=function(){var O=0,M=this.s&L.DM;for(var N=0;N<this.t;++N){O+=L.cbit(this[N]^M)}return O};L.prototype.testBit=function(N){var M=Math.floor(N/L.DB);if(M>=this.t){return(this.s!=0)}return((this[M]&(1<<(N%L.DB)))!=0)};L.prototype.changeBit=function(O,N){var M=L.ONE.shiftLeft(O);this.bitwiseTo(M,N,M);return M};L.prototype.setBit=function(M){return this.changeBit(M,L.op_or)};L.prototype.clearBit=function(M){return this.changeBit(M,L.op_andnot)};L.prototype.flipBit=function(M){return this.changeBit(M,L.op_xor)};L.prototype.addTo=function(N,P){var O=0,Q=0,M=Math.min(N.t,this.t);while(O<M){Q+=this[O]+N[O];P[O++]=Q&L.DM;Q>>=L.DB}if(N.t<this.t){Q+=N.s;while(O<this.t){Q+=this[O];P[O++]=Q&L.DM;Q>>=L.DB}Q+=this.s}else{Q+=this.s;while(O<N.t){Q+=N[O];P[O++]=Q&L.DM;Q>>=L.DB}Q+=N.s}P.s=(Q<0)?-1:0;if(Q>0){P[O++]=Q}else{if(Q<-1){P[O++]=L.DV+Q}}P.t=O;P.clamp()};L.prototype.ope_add=function(M){var N=new L();this.addTo(M,N);return N};L.prototype.add=L.prototype.ope_add;L.prototype.ope_subtract=function(M){var N=new L();this.subTo(M,N);return N};L.prototype.subtract=L.prototype.ope_subtract;L.prototype.ope_multiply=function(M){var N=new L();this.multiplyTo(M,N);return N};L.prototype.multiply=L.prototype.ope_multiply;L.prototype.ope_divide=function(M){var N=new L();this.divRemTo(M,N,null);return N};L.prototype.divide=L.prototype.ope_divide;L.prototype.ope_remainder=function(M){var N=new L();this.divRemTo(M,null,N);return N};L.prototype.remainder=L.prototype.ope_remainder;L.prototype.ope_divideAndRemainder=function(M){var O=new L(),N=new L();this.divRemTo(M,O,N);return new Array(O,N)};L.prototype.divideAndRemainder=L.prototype.ope_divideAndRemainder;L.prototype.dMultiply=function(M){this[this.t]=this.am(0,M-1,this,0,0,this.t);++this.t;this.clamp()};L.prototype.dAddOffset=function(N,M){while(this.t<=M){this[this.t++]=0}this[M]+=N;while(this[M]>=L.DV){this[M]-=L.DV;if(++M>=this.t){this[this.t++]=0}++this[M]}};var H=function(){this.convert=function(M){return M};this.revert=function(M){return M};this.mulTo=function(M,O,N){M.multiplyTo(O,N)};this.sqrTo=function(M,N){M.squareTo(N)}};L.prototype.ope_pow=function(M){return this.exp(M,new L.NullExp())};L.prototype.pow=L.prototype.ope_pow;L.prototype.multiplyLowerTo=function(M,Q,P){var O=Math.min(this.t+M.t,Q);P.s=0;P.t=O;while(O>0){P[--O]=0}var N;for(N=P.t-this.t;O<N;++O){P[O+this.t]=this.am(0,M[O],P,O,0,this.t)}for(N=Math.min(M.t,Q);O<N;++O){this.am(0,M[O],P,O,0,Q-O)}P.clamp()};L.prototype.multiplyUpperTo=function(M,P,O){--P;var N=O.t=this.t+M.t-P;O.s=0;while(--N>=0){O[N]=0}for(N=Math.max(P-this.t,0);N<M.t;++N){O[this.t+N-P]=this.am(P-N,M[N],O,0,0,this.t+N-P)}O.clamp();O.drShiftTo(1,O)};var F=function(M){this.r2=new L();this.q3=new L();L.ONE.dlShiftTo(2*M.t,this.r2);this.mu=this.r2.divide(M);this.m=M;this.concert=function(N){if(N.s<0||N.t>2*this.m.t){return N.mod(this.m)}else{if(N.compareTo(this.m)<0){return N}else{var O=new L();N.copyTo(O);this.reduce(O);return O}}};this.revert=function(N){return N};this.reduce=function(N){N.drShiftTo(this.m.t-1,this.r2);if(N.t>this.m.t+1){N.t=this.m.t+1;N.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(N.compareTo(this.r2)<0){N.dAddOffset(1,this.m.t+1)}N.subTo(this.r2,N);while(N.compareTo(this.m)>=0){N.subTo(this.m,N)}};this.sqrTo=function(N,O){N.squareTo(O);this.reduce(O)};this.mulTo=function(N,P,O){N.multiplyTo(P,O);this.reduce(O)}};L.Barrett=F;L.prototype.modPow=function(ae,Y){var af=c.create();af.start("modPow");var ac=ae.bitLength(),Z,W=new L(1),T;if(ac<=0){return W}else{if(ac<18){Z=1}else{if(ac<48){Z=3}else{if(ac<144){Z=4}else{if(ac<768){Z=5}else{Z=6}}}}}if(ac<8){T=new L.Classic(Y)}else{if(Y.isEven()){T=new L.Barrett(Y)}else{T=new L.Montgomery(Y)}}var ad=new Array(),X=3,S=Z-1,M=(1<<Z)-1;ad[1]=T.convert(this);if(Z>1){var ag=new L();T.sqrTo(ad[1],ag);while(X<=M){ad[X]=new L();T.mulTo(ag,ad[X-2],ad[X]);X+=2}}var R=c.create();var Q=c.create();var P=c.create();var O=c.create();var ab=ae.t-1,U,N=true,aa=new L(),V;ac=L.nbits(ae[ab])-1;while(ab>=0){R.start("modPow1");if(ac>=S){U=(ae[ab]>>(ac-S))&M}else{U=(ae[ab]&((1<<(ac+1))-1))<<(S-ac);if(ab>0){U|=ae[ab-1]>>(L.DB+ac-S)}}X=Z;while((U&1)==0){U>>=1;--X}if((ac-=X)<0){ac+=L.DB;--ab}R.stop();Q.start("modPow2");Q.stop();P.start("modPow3");if(N){ad[U].copyTo(W);N=false}else{while(X>1){T.sqrTo(W,aa);T.sqrTo(aa,W);X-=2}if(X>0){T.sqrTo(W,aa)}else{V=W;W=aa;aa=V}T.mulTo(aa,ad[U],W)}P.stop();O.start("modPow4");while(ab>=0&&(ae[ab]&(1<<ac))==0){T.sqrTo(W,aa);V=W;W=aa;aa=V;if(--ac<0){ac=L.DB-1;--ab}}O.stop()}af.stop();return T.revert(W)};L.prototype.gcd=function(N){var M=(this.s<0)?this.negate():this.clone();var R=(N.s<0)?N.negate():N.clone();if(M.compareTo(R)<0){var P=M;M=R;R=P}var O=M.getLowestSetBit(),Q=R.getLowestSetBit();if(Q<0){return M}if(O<Q){Q=O}if(Q>0){M.rShiftTo(Q,M);R.rShiftTo(Q,R)}while(M.signum()>0){if((O=M.getLowestSetBit())>0){M.rShiftTo(O,M)}if((O=R.getLowestSetBit())>0){R.rShiftTo(O,R)}if(M.compareTo(R)>=0){M.subTo(R,M);M.rShiftTo(1,M)}else{R.subTo(M,R);R.rShiftTo(1,R)}}if(Q>0){R.lShiftTo(Q,R)}return R};L.prototype.modInt=function(P){if(P<=0){return 0}var O=L.DV%P,N=(this.s<0)?P-1:0;if(this.t>0){if(O==0){N=this[0]%P}else{for(var M=this.t-1;M>=0;--M){N=(O*N+this[M])%P}}}return N};L.prototype.modInverse=function(N){var R=N.isEven();if((this.isEven()&&R)||N.signum()==0){return L.ZERO}var Q=N.clone(),P=this.clone();var O=new L(1),M=new L(0),T=new L(0),S=new L(1);while(Q.signum()!=0){while(Q.isEven()){Q.rShiftTo(1,Q);if(R){if(!O.isEven()||!M.isEven()){O.addTo(this,O);M.subTo(N,M)}O.rShiftTo(1,O)}else{if(!M.isEven()){M.subTo(N,M)}}M.rShiftTo(1,M)}while(P.isEven()){P.rShiftTo(1,P);if(R){if(!T.isEven()||!S.isEven()){T.addTo(this,T);S.subTo(N,S)}T.rShiftTo(1,T)}else{if(!S.isEven()){S.subTo(N,S)}}S.rShiftTo(1,S)}if(Q.compareTo(P)>=0){Q.subTo(P,Q);if(R){O.subTo(T,O)}M.subTo(S,M)}else{P.subTo(Q,P);if(R){T.subTo(O,T)}S.subTo(M,S)}}if(P.compareTo(L.ONE)!=0){return L.ZERO}if(S.compareTo(N)>=0){return S.subtract(N)}if(S.signum()<0){S.addTo(N,S)}else{return S}if(S.signum()<0){return S.ope_add(N)}else{return S}};var J=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];var G=(1<<26)/J[J.length-1];L.lowprimes=J;L.lplim=G;L.prototype.isProbablePrime=function(R){var T=c.create();T.start("isProbablePrime");var Q,O=this.abs();if(O.t==1&&O[0]<=J[J.length-1]){for(Q=0;Q<J.length;++Q){if(O[0]==J[Q]){return true}}return false}if(O.isEven()){return false}Q=1;while(Q<J.length){var N=J[Q];var P=Q+1;while(P<J.length&&N<G){N*=J[P++]}N=O.modInt(N);while(Q<P){if(N%J[Q++]==0){return false}}}var S=c.create();S.start("isProbablePrime.millerRabin");var M=O.millerRabin(R);S.stop();T.stop();return M};L.prototype.millerRabin=function(Q){var R=this.subtract(L.ONE);var N=R.getLowestSetBit();if(N<=0){return false}var S=R.shiftRight(N);Q=(Q+1)>>1;if(Q>J.length){Q=J.length}var M=new L();for(var P=0;P<Q;++P){M.fromInt(J[P]);var T=M.modPow(S,this);if(T.compareTo(L.ONE)!=0&&T.compareTo(R)!=0){var O=1;while(O++<N&&T.compareTo(R)!=0){T=T.modPowInt(2,this);if(T.compareTo(L.ONE)==0){return false}}if(T.compareTo(R)!=0){return false}}}return true};L.NullExp=H}i(this);function B(H){w("RSA.init2.js");f("packages.js");f("SecureRandom.js");f("BigInteger.init1.js");f("BigInteger.init2.js");f("RSA.init1.js");f("elapse.js");var G=o(H,"titaniumcore.crypto.RSA");var I=o(H,"titaniumcore.crypto.BigInteger");var F=o(H,"titaniumcore.crypto.SecureRandom");G.prototype.privateKey=function(M,K,L,J){if(arguments.length==0){return{n:this.n,e:this.e,d:this.d,ksize:this.ksize}}else{this._n(M);this._e(K);this._d(L);this._ksize(J)}};G.prototype.key=function(Q,N,O,M,L,P,J,K){if(arguments.length==0){return{n:this.n,e:this.e,d:this.d,p:this.p,q:this.q,dmp1:this.dmp1,dmq1:this.dmq1,coeff:this.coeff}}else{this._n(Q);this._e(N);this._d(O);this._p(M);this._q(L);this._dmp1(P);this._dmq1(J);this._coeff(K)}};G.prototype.splitBitLength=function(K){if(this.tolerantlyGenerate){var J=K>>1;return[K-J+1,J+1]}else{trace("strict1");var J=K>>1;return[K-J,J]}};G.prototype.isProperBitLength=function(J,K){if(this.tolerantlyGenerate){return true}else{trace("strict2");return K==J.bitLength()}};G.prototype.generate=function(K,U){var J=new F();var R=this.splitBitLength(K);this._e(U);var O=new I(this.e);for(;;){var N=c.create();for(;;){N.start("generateLoop1");this.p=new I(R[0],1,J);N.stop();if(this.p.subtract(I.ONE).gcd(O).compareTo(I.ONE)==0&&this.p.isProbablePrime(10)){break}}var M=c.create();for(;;){M.start("generateLoop2");this.q=new I(R[1],1,J);M.stop();if(this.q.subtract(I.ONE).gcd(O).compareTo(I.ONE)==0&&this.q.isProbablePrime(10)){break}}var L=this.p.compareTo(this.q);if(L==0){continue}else{if(L<0){var T=this.p;this.p=this.q;this.q=T}}var S=this.p.subtract(I.ONE);var P=this.q.subtract(I.ONE);var Q=S.multiply(P);if(Q.gcd(O).compareTo(I.ONE)==0){this.n=this.p.multiply(this.q);if(!this.isProperBitLength(this.n,K)){continue}this.d=O.modInverse(Q);this.dmp1=this.d.mod(S);this.dmq1=this.d.mod(P);this.coeff=this.q.modInverse(this.p);break}}this._ksize(K)};G.prototype.processPrivate=function(K){K=this.preprocessPrivate(K);if(this.p==null||this.q==null){return K.modPow(this.d,this.n)}else{var L=K.mod(this.p).modPow(this.dmp1,this.p);var J=K.mod(this.q).modPow(this.dmq1,this.q);while(L.compareTo(J)<0){L=L.ope_add(this.p)}return L.subtract(J).multiply(this.coeff).mod(this.p).multiply(this.q).ope_add(J)}};G.prototype.privateEncrypt=function(J){if(this.messageFormat==null){throw"Error. No message format is installed."}return this.messageFormat.privateEncrypt(this,J)};G.prototype.privateDecrypt=function(J){if(this.messageFormat==null){throw"Error. No message format is installed."}return this.messageFormat.privateDecrypt(this,J)};G.prototype.privateEncryptMaxSize=function(){if(this.messageFormat==null){throw"Error. No message format is installed."}return this.messageFormat.privateEncryptMaxSize(this)};G.prototype.privateKeyBytes=function(){if(this.keyFormat==null){throw"Error. No key format is installed."}if(arguments.length==0){if(this.ksize==null||this.ksize==0){throw"key size is not set."}return this.keyFormat.encodePrivateKey(this.n,this.e,this.d,this.ksize)}else{var J=this.keyFormat.decodePrivateKey(arguments[0]);this.privateKey(J.n,J.e,J.d,J.ksize);return this}}}B(this);function x(ap){if(ap.__PACKAGE_ENABLED){w("nonstructured.js")}P.log=function(aH){return};P.err=function(aH){trace(aH);return};var N=function(aH){P.log(aH);return};var aA=function(aH){P.err(aH);return};function P(){this._stack=[];this._scope={};this._frequency=P.frequency;this._timeout=1;this._done=function(){};this._progress=function(){};this._limit=ah(-1);if(0<arguments.length){var aH=[];for(var aI=0;aI<arguments.length;aI++){aH[aI]=arguments[aI]}this.initialize(aH)}}P.frequency=1;function ah(aH){if(aH<0){return function(aI){return false}}else{return function(aI){return aH<aI}}}function I(aJ){var aK=new aE();var aH=new aE();for(var aI=0;aI<aJ.length;aI++){this._stack[aI]=new ac(aJ[aI],aH,aK);aK=aH;aH=new aE()}return this}P.prototype.initialize=I;var aw=function(aL,aK,aI,aJ,aH){return aK(aI,aJ,aH)};var G=function(aO,aN,aK,aM,aJ){var aI=(aN.__NAME==null)?"CLOSURE="+(aO==null?"unknown":aO):"CLOSURE="+aN.__NAME+"/"+(aO==null?"unknown":aO);var aL=c.create();aL.start(aI);var aH=aN(aK,aM,aJ);aL.stop();return aH};var ar=aw;P.traceResponce=function(aH){if(aH){ar=G}else{ar=aw}};P.prototype.process=function(){if(this._stack.length==0){return false}var aH;var aJ=this._stack[0];var aK=aJ.closure;var aI=this._scope;aK=az(aK);aH=ar("others",aK,aI,aJ.param,aJ.subparam);N("process() closure() result: "+aH);if(aH===undefined){aA("*** WARNING MAY BE MISSING return STATEMENT *** ")}if(aH){}else{aH=O}if(!aH.IS_CONTINUE()){this._stack.shift()}if(aH.IS_RESULT_WRAPPER()){aH=aH.unwrap()}if(aH.IS_RUNNABLE()&&!aH.IS_FLOW_CONTROLLER()){this._stack.unshift(new ac(aH,aJ.subparam,new aE()))}return 0<this._stack.length};P.prototype.step=P.prototype.process;P.prototype.limit=function(aH){if(arguments.length==0){return this._limit}else{this._limit=ah(aH);return this}};P.prototype.frequency=function(aH){if(arguments.length==0){return this._frequency}else{this._frequency=aH;return this}};P.prototype.timeout=function(aH){if(arguments.length==0){return this._timeout}else{this._timeout=aH;return this}};P.prototype.done=function(aH){if(arguments.length==0){return this._done}else{this._done=aH;return this}};P.prototype.progress=function(aH){if(arguments.length==0){return this._progress}else{this._progress=aH;return this}};P.prototype.go=function(){N("go()");if(this._frequency<=0){return aa(this,this._limit,this._done,this._progress)}else{return H(this,this._frequency,this._timeout,this._limit,this._done,this._progress)}};function ac(aJ,aI,aH){this.closure=aJ;this.param=aI;this.subparam=aH}function aE(){}aE.prototype.toString=function(){var aJ=[];for(var aK in this){if(Object.prototype[aK]==null){aJ.push(aK)}}aJ.sort();var aI="";for(var aH=0;aH<aJ.length;aH++){aI=aI+aJ[aH]+"="+this[aJ[aH]]+"\n"}return"class Param(\n"+aI+")"};function av(aH){this.result=aH}av.prototype.toString=function(){return"class ResultWrapper() : "+this.result};av.prototype.unwrap=function(){if(this.result.IS_RESULT_WRAPPER()){return this.result.unwrap()}else{return this.result}};function az(aH){if(aH.IS_RESULT_WRAPPER!=null&&aH.IS_RESULT_WRAPPER()){aH=aH.unwrap()}if(aH.__installedClosure==null){if((typeof aH)!="function"){aH.__installedClosure=X(aH)}else{aH.__installedClosure=aH}}return aH.__installedClosure}function ab(aH){var aI=function(){return aI};aI.toString=function(){return"FlowController."+aH+""};return aI}function at(aH){return function(aI){return(new Object()).LABEL(aI)}}var O=ab("CONTINUE");var al=ab("BREAK");var L=ab("AGAIN");var Y=ab("EXIT");var aD=at();var S=function(aI,aL,aH){var aK=true;var aJ=function(aN,aP,aO){aP.FOR=aI;if(aK){aK=false;N("FOR:(first)"+aL(aI));var aM=aL(aI);if(undefined===aM){aA("******** FOR : missing return statement in the condition closure **********")}return aM?al:Y}else{N("FOR:");aH(aI);var aM=aL(aI);if(undefined===aM){aA("******** FOR : missing return statement in the condition closure **********")}return aM?al:Y}};aJ.variable=aI;return aJ};aD.toString=function(){return"FlowController.LABEL(null)"};S.toString=function(){return"FlowController.FOR(null)"};function aj(aI,aH){aI=""+aI;while(aI.length<aH){aI="0"+aI}return aI}function X(aR){N("Nonstructured.list start : the number of closures:"+aR.length);var aO=c.create();var aM=true;var aP=function(){aM=false;aO.start("CLOSURE="+aH+"(total)")};var aI=function(){aO.stop();aM=true;aN()};var aH=aR.__NAME;var aK=aR.__LABEL_NAME;var aJ=0;function aN(){aJ=0}function aL(){aJ++}var aQ=function(aV,aW,aU){if(aM){aP()}var aX=az(aR[aJ]);var aT=aX.__NAME==null?aH+"("+aj(aJ,2)+")":aX.__NAME;var aS=ar(aT,aX,aV,aW,aU);N("list() closure() result: "+aS);if(aS===undefined){aA("*** WARNING MISSING return STATEMENT ***")}if(aS){}else{aS=O}if(aS.IS_FLOW_CONTROLLER()){if((!aS.IS_LABEL())||(aS.LABELED()==aR.IDENTIFIED())){if(aS.IS_CONTINUE()){aS=O}else{if(aS.IS_BREAK()){aL();aS=O}else{if(aS.IS_AGAIN()){aN();aS=O}else{if(aS.IS_EXIT()){aI();aS=al}else{aA("*** warning list() warning *** ");aL();aS=O}}}}}else{aI()}if(aR.length<=aJ){aA("WARNING(1) *** MULTI-STATEMENT OVERED ITS LAST STATEMENT *** MAYBE MISSING FLOW-CONTROLLER *** ");aI();aS=al}}else{if((!aS.IS_LABEL())||(aS.LABELED()==aR.IDENTIFIED())){if(aS.IS_CONTINUE()){aS=new av(aS).CONTINUE()}else{if(aS.IS_BREAK()){aL();aS=new av(aS).CONTINUE()}else{if(aS.IS_AGAIN()){aN();aS=new av(aS).CONTINUE()}else{if(aS.IS_EXIT()){aI();aS=new av(aS).BREAK()}else{aL();aS=new av(aS).CONTINUE()}}}}}else{aI()}if(aR.length<=aJ){aA("WARNING(2) *** MULTI-STATEMENT OVERED ITS LAST STATEMENT *** MAYBE MISSING FLOW-CONTROLLER *** ");aI();aS=new av(aS).BREAK()}}return aS};if(aK!=null){aQ.__LABEL_NAME=aK}if(aH!=null){aQ.__NAME=aH}return aQ}function aa(aN,aI,aH,aK){N("Nonstructured.executeSync:start >> ");var aM=0;var aL=new Date();for(;;){aM++;if(!aN.process()){N("Nonstructured.executeSync:done <<");var aJ=new Date();aH(true,aM,(aJ.getTime()-aL.getTime()),aL,aJ);break}aK(aM);if(aI(aM)){N("Nonstructured.executeSync:done ( exceed count limit ) <<");var aJ=new Date();aH(false,aM,(aJ.getTime()-aL.getTime()),aL,aJ);break}}return null}function H(aQ,aR,aS,aL,aN,aH){N("Nonstructured.executeAsync:start >>");var aJ=new Date();var aM;var aK=false;var aP=0;var aO=function(){if(aK){N("confliction was detected.");return}else{aK=true;var aU=new Date().getTime();for(var aT=0;;aT++){aP++;if(!aQ.process()){N("Nonstructured.executeAsync:done <<");clearInterval(aI);aM=new Date();aN(true,aP,(aM.getTime()-aJ.getTime()),aJ,aM);break}aH(aP);if(aL(aP)){N("Nonstructured.executeAsync:done (exceed count limit)  <<");clearInterval(aI);aM=new Date();aN(false,aP,(aM.getTime()-aJ.getTime()),aJ,aM);break}var aV=new Date().getTime();if(aS<aV-aU){N("Async:count"+aT);break}}aK=false}};var aI=setInterval(aO,aR);return aI}function am(aH){return function(){this[aH]=true;return this}}function Z(aH){return function(){delete this[aH];return this}}function M(aH){return function(){return(this[aH]!=null?true:false)}}function aq(aI,aH){return function(aJ){if(aJ==null){aJ=aH}this[aI]=aJ;return this}}function au(aI,aH){return function(aJ){return this[aI]}}var ay="DEFAULT_LABEL";var U=am("__BREAK");var ae=am("__CONTINUE");var aC=am("__AGAIN");var aF=am("__EXIT");var an=aq("__LABEL",ay);var aB=Z("__BREAK");var Q=Z("__CONTINUE");var ad=Z("__AGAIN");var V=Z("__EXIT");var R=Z("__LABEL",ay);var F=M("__BREAK");var aG=M("__CONTINUE");var ak=M("__AGAIN");var ax=M("__EXIT");var T=M("__LABEL",ay);var ag=au("__LABEL",ay);var ai=function(){return true};var af=function(){return false};var W=function(aH){if(aH==null){aH=ay}this.__LABEL_NAME=aH;return this};var ao=function(){return this.__LABEL_NAME};function K(){return new P(this)}function J(aH){if(arguments.length==0){return this.__NAME}else{this.__NAME=aH;return this}}Function.prototype.ready=K;Array.prototype.ready=K;Object.prototype.NAME=J;Object.prototype.IDENTIFY=W;Object.prototype.IDENTIFIED=ao;Object.prototype.AGAIN=aC;Object.prototype.EXIT=aF;Object.prototype.CONTINUE=ae;Object.prototype.BREAK=U;Object.prototype.LABEL=an;Object.prototype.IS_AGAIN=ak;Object.prototype.IS_EXIT=ax;Object.prototype.IS_CONTINUE=aG;Object.prototype.IS_BREAK=F;Object.prototype.IS_LABEL=T;Object.prototype.RESET_AGAIN=ad;Object.prototype.RESET_EXIT=V;Object.prototype.RESET_CONTINUE=Q;Object.prototype.RESET_BREAK=aB;Object.prototype.RESET_LABEL=R;Object.prototype.LABELED=ag;Object.prototype.IS_RUNNABLE=af;Object.prototype.IS_RESULT_WRAPPER=af;Object.prototype.IS_FLOW_CONTROLLER=af;Function.prototype.IS_RUNNABLE=ai;Array.prototype.IS_RUNNABLE=ai;av.prototype.IS_RESULT_WRAPPER=ai;O.CONTINUE();al.BREAK();L.AGAIN();Y.EXIT();aD.LABEL().EXIT();O.IS_FLOW_CONTROLLER=ai;al.IS_FLOW_CONTROLLER=ai;L.IS_FLOW_CONTROLLER=ai;Y.IS_FLOW_CONTROLLER=ai;aD.IS_FLOW_CONTROLLER=ai;ap.Nonstructured=P;ap.CONTINUE=O;ap.BREAK=al;ap.AGAIN=L;ap.EXIT=Y;ap.LABEL=aD;ap.FOR=S}x(this);function h(G){w("BigInteger.init3.js");f("packages.js");f("BigInteger.init1.js");f("BigInteger.init2.js");var I=o(G,"titaniumcore.crypto.BigInteger");var H=I.lowprimes;var F=I.lplim;I.prototype.stepping_fromNumber1=function(M,N,K){var J=this;I.log("stepping_fromNumber1");var L={toString:function(){return"*** FAILED TO RETRIEVE RESULT ***"}};return function(){I.log("stepping_fromNumber1.1");if(M<2){J.fromInt(1);return BREAK}else{J.fromNumber2(M,K);if(!J.testBit(M-1)){J.bitwiseTo(I.ONE.shiftLeft(M-1),I.op_or,J)}if(J.isEven()){J.dAddOffset(1,0)}I.log("stepping_fromNumber1.2");return[function(P,Q,O){O.result=L;I.log("stepping_fromNumber1.2.1.1: calling stepping_isProbablePrime");return J.stepping_isProbablePrime(N).BREAK()},function(Q,R,P){I.log("stepping_fromNumber1.2.1.2: returned stepping_isProbablePrime:"+P.result);if(P.result==null||P.result==L){I.err("stepping_fromNumber1.2.1.2: returned stepping_isProbablePrime: subparam.result == WARNING NULL "+P.result)}var O=P.result;if(O){return EXIT}else{return BREAK}},function(){I.log("stepping_fromNumber1.2.2");J.dAddOffset(2,0);if(J.bitLength()>M){J.subTo(I.ONE.shiftLeft(M-1),J)}return BREAK},AGAIN].BREAK()}}};I.prototype.stepping_isProbablePrime=function(L){I.log("stepping_isProbablePrime:create");var K=this;var J=K.abs();var N=c.create();var M=c.create();return[function(S,T,Q){I.log("stepping_isProbablePrime No.1: ");N.start("stepping_isProbablePrime");var R;if(J.t==1&&J[0]<=H[H.length-1]){for(R=0;R<H.length;++R){if(J[0]==H[R]){I.log("stepping_isProbablePrime.1 EXIT");T.result=true;return EXIT}}I.log("stepping_isProbablePrime.2 EXIT");T.result=false;return EXIT}if(J.isEven()){I.log("stepping_isProbablePrime.3 EXIT");T.result=false;return EXIT}R=1;while(R<H.length){var O=H[R];var P=R+1;while(P<H.length&&O<F){O*=H[P++]}O=J.modInt(O);while(R<P){if(O%H[R++]==0){I.log("stepping_isProbablePrime:4 EXIT");T.result=false;return EXIT}}}I.log("stepping_isProbablePrime:5 BREAK");return BREAK},function(P,Q,O){I.log("stepping_isProbablePrime No.2: calling millerRabin : subparam.result="+O.result);M.start("isProbablePrime.millerRabin");O.result=null;return J.stepping_millerRabin(L).BREAK()},function(P,Q,O){I.log("stepping_isProbablePrime No.3: returning millerRabin : subparam.result="+O.result);M.stop();N.stop();Q.result=O.result;I.log("stepping_isProbablePrime No.3: param.result="+Q.result);return BREAK},EXIT].NAME("stepping_isProbablePrime")};I.prototype.stepping_millerRabin=function(N){I.log("stepping_millerRabin");var L=this;var O;var K;var P;var J;var M=0;var Q;return[function(S,T,R){I.log("stepping_millerRabin:No1");O=L.subtract(I.ONE);K=O.getLowestSetBit();if(K<=0){T.result=false;return EXIT}P=O.shiftRight(K);N=(N+1)>>1;if(N>H.length){N=H.length}J=new I();return BREAK},[function(){I.log("stepping_millerRabin:No2.1");if(M<N){I.log("stepping_millerRabin:No2.1.1");return BREAK}else{I.log("stepping_millerRabin:No2.1.2");return EXIT}},function(){I.log("stepping_millerRabin:No2.2");J.fromInt(H[M]);return BREAK},function(){I.log("stepping_millerRabin:No2.3 : calling stepping_modPow()");return J.stepping_modPow(P,L).BREAK()},function(S,T,R){Q=R.result;I.log("stepping_millerRabin:No2.4 : returned from stepping_modPow() result="+Q);return BREAK},function(T,U,S){I.log("stepping_millerRabin:No2.5 ");if(Q.compareTo(I.ONE)!=0&&Q.compareTo(O)!=0){I.log("stepping_millerRabin:No2.5.1 ");var R=1;while(R++<K&&Q.compareTo(O)!=0){I.log("stepping_millerRabin:No2.5.2 j="+R);Q=Q.modPowInt(2,L);if(Q.compareTo(I.ONE)==0){I.log("stepping_millerRabin:No2.5.3 ");U.result=false;return LABEL("LOOP1").EXIT()}}if(Q.compareTo(O)!=0){U.result=false;I.log("stepping_millerRabin:No2.5.4 "+U);return LABEL("LOOP1").EXIT()}I.log("stepping_millerRabin:No2.5.5 ")}I.log("stepping_millerRabin:No2.5.2 ");return BREAK},function(){I.log("stepping_millerRabin:No2.6");++M;return BREAK},AGAIN],function(S,T,R){T.result=true;I.log("stepping_millerRabin:No3 : param.result="+T.result);return EXIT},AGAIN].IDENTIFY("LOOP1")};I.prototype.stepping_modPow=function(Z,T){var aa=c.create();var N=c.create();var M=c.create();var L=c.create();var K=c.create();var S=this;var X,U,R,O;var Y;var V,P,J,W,Q;return[function(ad,ae,ac){I.log("stepping_modPow 1:");aa.start("modPow");X=Z.bitLength();R=new I(1);if(X<=0){ae.result=R;return EXIT}else{if(X<18){U=1}else{if(X<48){U=3}else{if(X<144){U=4}else{if(X<768){U=5}else{U=6}}}}}if(X<8){O=new I.Classic(T)}else{if(T.isEven()){O=new I.Barrett(T)}else{O=new I.Montgomery(T)}}Y=new Array(),n=3,k1=U-1,km=(1<<U)-1;Y[1]=O.convert(S);if(U>1){var ab=new I();O.sqrTo(Y[1],ab);while(n<=km){Y[n]=new I();O.mulTo(ab,Y[n-2],Y[n]);n+=2}}V=Z.t-1;J=true;W=new I();X=I.nbits(Z[V])-1;return BREAK},function(ac,ad,ab){I.log("stepping_modPow 2: j="+V);if(V>=0){N.start("modPow1");if(X>=k1){P=(Z[V]>>(X-k1))&km}else{P=(Z[V]&((1<<(X+1))-1))<<(k1-X);if(V>0){P|=Z[V-1]>>(I.DB+X-k1)}}n=U;while((P&1)==0){P>>=1;--n}if((X-=n)<0){X+=I.DB;--V}N.stop();M.start("modPow2");M.stop();L.start("modPow3");if(J){Y[P].copyTo(R);J=false}else{while(n>1){O.sqrTo(R,W);O.sqrTo(W,R);n-=2}if(n>0){O.sqrTo(R,W)}else{Q=R;R=W;W=Q}O.mulTo(W,Y[P],R)}L.stop();K.start("modPow4");while(V>=0&&(Z[V]&(1<<X))==0){O.sqrTo(R,W);Q=R;R=W;W=Q;if(--X<0){X=I.DB-1;--V}}K.stop();return CONTINUE}else{return BREAK}},function(ac,ad,ab){aa.stop();ad.result=O.revert(R);I.log("stepping_modPow 3:result="+ad.result);return EXIT},AGAIN]};I.prototype.exp=function(O,P){if(O>4294967295||O<1){return I.ONE}var N=new I(),J=new I(),M=P.convert(this),L=I.nbits(O)-1;M.copyTo(N);while(--L>=0){P.sqrTo(N,J);if((O&(1<<L))>0){P.mulTo(J,M,N)}else{var K=N;N=J;J=K}}return P.revert(N)};I.prototype.modPowInt=function(K,J){var L;if(K<256||J.isEven()){L=new I.Classic(J)}else{L=new I.Montgomery(J)}return this.exp(K,L)}}h(this);function A(H){w("RSA.init3.js");f("packages.js");f("SecureRandom.js");f("BigInteger.init1.js");f("BigInteger.init2.js");f("nonstructured.js");f("BigInteger.init3.js");f("RSA.init1.js");f("RSA.init2.js");var G=o(H,"titaniumcore.crypto.RSA");var I=o(H,"titaniumcore.crypto.BigInteger");var F=o(H,"titaniumcore.crypto.SecureRandom");G.prototype.generateAsync=function(O,Q,M,J,K){var L=this;var P=this.stepping_generate(O,Q);var N=function(){J(L);return BREAK};return([P,N,EXIT]).ready().frequency(1).timeout(1).progress(M).done(K).go()};G.prototype.processPublicAsync=function(M,L,J,K){var O=this.stepping_processPublic(M);var N=function(Q,R,P){J(P.result.toByteArray());return BREAK};return([O,N,EXIT]).ready().frequency(1).timeout(1).progress(L).done(K).go()};G.prototype.processPrivateAsync=function(M,L,J,K){var O=this.stepping_processPrivate(M);var N=function(Q,R,P){J(P.result.toByteArray());return BREAK};return([O,N,EXIT]).ready().frequency(1).timeout(1).progress(L).done(K).go()};G.prototype.privateEncryptAsync=function(M,L,J,K){if(this.messageFormat==null){throw"Error. No message format is installed."}return this.messageFormat.privateEncryptAsync(this,M,L,J,K)};G.prototype.privateDecryptAsync=function(M,L,J,K){if(this.messageFormat==null){throw"Error. No message format is installed."}return this.messageFormat.privateDecryptAsync(this,M,L,J,K)};G.prototype.stepping_generate=function(K,U){var T=this;var J;var R=this.splitBitLength(K);T._e(U);var O=new I(T.e);var S;var P;var Q;var N=c.create();var M=c.create();var L=c.create();return[function(){G.log("RSAEngine:0.0");N.start("Step1");return BREAK},[function(){G.log("RSAEngine:1.1");T.p=new I();J=new F();return BREAK},function(){G.log("RSAEngine:1.2");return T.p.stepping_fromNumber1(R[0],1,J).BREAK()},function(){G.log("RSAEngine:1.3.1");if(T.p.subtract(I.ONE).gcd(O).compareTo(I.ONE)==0){return BREAK}else{return AGAIN}},function(){G.log("RSAEngine:1.3.2 : calling stepping_isProbablePrime");return T.p.stepping_isProbablePrime(10).BREAK()},function(W,X,V){G.log("RSAEngine:1.3.3 : returned stepping_isProbablePrime"+V.result);if(V.result){G.log("RSAEngine:1.3.3=>EXIT");return EXIT}else{G.log("RSAEngine:1.3.3=>AGAIN");return AGAIN}},EXIT].NAME("stepping_generate.Step1"),function(){N.stop();G.log("RSAEngine:1.4");return BREAK},function(){G.log("RSAEngine:2.0");M.start("Step2");return BREAK},[function(){G.log("RSAEngine:2.1");T.q=new I();return BREAK},function(){G.log("RSAEngine:2.2");return T.q.stepping_fromNumber1(R[1],1,J).BREAK()},function(){G.log("RSAEngine:2.3.1");if(T.q.subtract(I.ONE).gcd(O).compareTo(I.ONE)==0){return BREAK}else{return AGAIN}},function(){G.log("RSAEngine:2.3.2");return T.q.stepping_isProbablePrime(10).BREAK()},function(W,X,V){G.log("RSAEngine:2.3.3:subparam.result="+V.result);if(V.result){G.log("RSAEngine:2.3.3=>EXIT");return EXIT}else{G.log("RSAEngine:2.3.3=>AGAIN");return AGAIN}},EXIT].NAME("stepping_generate.Step2"),function(){M.stop();G.log("RSAEngine:2.3");return BREAK},function(){if(T.p.compareTo(T.q)<=0){var V=T.p;T.p=T.q;T.q=V}return BREAK},function(){G.log("RSAEngine:3.1");G.log("p="+T.p.toString(16));G.log("q="+T.q.toString(16));L.start("Step3");return BREAK},function(){G.log("RSAEngine:3.2");S=T.p.subtract(I.ONE);P=T.q.subtract(I.ONE);Q=S.multiply(P);if(Q.gcd(O).compareTo(I.ONE)==0){G.log("RSAEngine:3.2=>BREAK");return BREAK}else{G.log("RSAEngine:3.2=>AGAIN");return AGAIN}},function(){G.log("RSAEngine:3.2.sub");if(T.p.compareTo(T.q)==0){G.log("RSAEngine:3.2.sub +++ P & Q ARE EQUAL !!!");return AGAIN}T.n=T.p.multiply(T.q);if(!T.isProperBitLength(T.n,K)){G.log("RSAEngine:3.3.2.1:AGAIN bitLength="+T.n.bitLength()+" B="+K);return AGAIN}return BREAK},function(){G.log("RSAEngine:3.3.1");var V=c.create();G.log("RSAEngine:3.3.1(1)");V.start("modInverse1");T.d=O.modInverse(Q);V.stop();G.log("RSAEngine:3.3.2(2)");T._ksize(K);return BREAK},function(){G.log("RSAEngine:3.3.2");var V=c.create();V.start("modInverse2");T.dmp1=T.d.mod(S);T.dmq1=T.d.mod(P);V.stop();return BREAK},function(){G.log("RSAEngine:3.3.3");var V=c.create();V.start("modInverse3");T.coeff=T.q.modInverse(T.p);V.stop();return BREAK},function(){L.stop();G.log("RSAEngine:3.5");return BREAK},EXIT].NAME("stepping_generate")};G.prototype.stepping_processPublic=function(J){return J.stepping_modPow(new I(this.e),this.n)};G.prototype.stepping_processPrivate=function(J){return J.stepping_modPow(this.d,this.n)}}A(this);function E(M){w("Cipher.js");f("packages.js");var aa=4294967295;function ae(am,an){return(am<<an|am>>>(8-an))&255}function N(am,an){return(am<<an|am>>>(32-an))&aa}function ah(am,an){return am[an]|am[an+1]<<8|am[an+2]<<16|am[an+3]<<24}function Z(an,ao,am){an.splice(ao,4,am&255,(am>>>8)&255,(am>>>16)&255,(am>>>24)&255)}function K(an,ao,am){an.splice(ao,4,(am>>>24)&255,(am>>>16)&255,(am>>>8)&255,am&255)}function L(am,an){return(am>>>(an*8))&255}function ac(am){var an=0;while(am>0){an++;am>>>=1}return an}function J(am){return(1<<am)-1}function R(){return Math.floor(Math.random()*256)}var ad={};function I(){var aK=null;var av=null;var aE=-1;var aI=null;aI="rijndael";var aM;var aL;var aC;var aA;var at;var aB;var aQ;var aD;var aR;var aq;var au;var aF;var aw;function aJ(aS,aT){return(aS&&aT)?aC[(aA[aS]+aA[aT])%255]:0}function aH(){return[ah(av,aE),ah(av,aE+4),ah(av,aE+8),ah(av,aE+12)]}function ao(aS){for(var aT=0;aT<4;aT++,aE+=4){Z(av,aE,aS[aT])}}function aP(aS){aS<<=1;return aS&256?aS^283:aS}function ax(aS){return at[L(aS,0)]|at[L(aS,1)]<<8|at[L(aS,2)]<<16|at[L(aS,3)]<<24}function ay(aT,aS){return aJ(L(aT,0),L(aS,0))^aJ(L(aT,1),L(aS,1))^aJ(L(aT,2),L(aS,2))^aJ(L(aT,3),L(aS,3))}function ar(aS){return ay(151849742,aS)|ay(218828297,aS)<<8|ay(185469197,aS)<<16|ay(235474187,aS)<<24}function ap(aS){var aT=aC[255-aA[aS]];aS=aT;aS=ae(aS,1);aT^=aS;aS=ae(aS,1);aT^=aS;aS=ae(aS,1);aT^=aS;aS=ae(aS,1);return aS^aT^99}function am(){var aS,aT;aC=[1,3];aA=[0,0,null,1];at=new Array(256);aB=new Array(256);aD=new Array(256);aR=new Array(256);aQ=new Array(30);for(aS=2;aS<256;aS++){aC[aS]=aC[aS-1]^aP(aC[aS-1]);aA[aC[aS]]=aS}at[0]=99;aB[99]=0;for(aS=1;aS<256;aS++){aT=ap(aS);at[aS]=aT;aB[aT]=aS}for(aS=0,aT=1;aS<30;aS++){aQ[aS]=aT;aT=aP(aT)}for(aS=0;aS<256;aS++){aT=at[aS];aD[aS]=aP(aT)|aT<<8|aT<<16|(aT^aP(aT))<<24;aT=aB[aS];aR[aS]=aJ(14,aT)|aJ(9,aT)<<8|aJ(13,aT)<<16|aJ(11,aT)<<24}}function an(aX){aK=aX;aK=aK.slice(0,32);var aW,aU,aS;var aV=0;var aT=aK.length;while(aT!=16&&aT!=24&&aT!=32){aK[aT++]=aK[aV++]}am();aM=aK.length>>>2;aL=6+aM;var aY=4*(aL+1);aq=new Array(12);au=new Array(12);aF=new Array(aY);aw=new Array(aY);for(aS=aV=0;aV<4;aV++,aS+=3){aq[aS]=(aV+1)%4;aq[aS+1]=(aV+2)%4;aq[aS+2]=(aV+3)%4;au[aS]=(4+aV-1)%4;au[aS+1]=(4+aV-2)%4;au[aS+2]=(4+aV-3)%4}for(aW=aV=0;aW<aM;aW++,aV+=4){aF[aW]=ah(aK,aV)}for(aU=0,aV=aM;aV<aY;aV+=aM,aU++){aF[aV]=aF[aV-aM]^ax(N(aF[aV-1],24))^aQ[aU];if(aM<=6){for(aW=1;aW<aM&&(aW+aV)<aY;aW++){aF[aW+aV]=aF[aW+aV-aM]^aF[aW+aV-1]}}else{for(aW=1;aW<4&&(aW+aV)<aY;aW++){aF[aW+aV]=aF[aW+aV-aM]^aF[aW+aV-1]}if((aV+4)<aY){aF[aV+4]=aF[aV+4-aM]^ax(aF[aV+3])}for(aW=5;aW<aM&&(aW+aV)<aY;aW++){aF[aW+aV]=aF[aW+aV-aM]^aF[aW+aV-1]}}}for(aV=0;aV<4;aV++){aw[aV+aY-4]=aF[aV]}for(aW=4;aW<aY-4;aW+=4){aU=aY-4-aW;for(aV=0;aV<4;aV++){aw[aU+aV]=ar(aF[aW+aV])}}for(aV=aY-4;aV<aY;aV++){aw[aV-aY+4]=aF[aV]}}function aO(){aC=aA=at=aB=aQ=null;aD=aR=aq=au=aF=aw=null}function aG(aV,a0,a2,aU,aZ){var aX=new Array(4);var aY,aW,aT,aS;for(aS=0;aS<4;aS++){aV[aS]^=a0[aS]}for(aY=1;aY<aL;aY++){for(aW=aT=0;aW<4;aW++,aT+=3){aX[aW]=a0[aS++]^a2[aV[aW]&255]^N(a2[(aV[aU[aT]]>>>8)&255],8)^N(a2[(aV[aU[aT+1]]>>>16)&255],16)^N(a2[(aV[aU[aT+2]]>>>24)&255],24)}var a1=aV;aV=aX;aX=a1}for(aW=aT=0;aW<4;aW++,aT+=3){aX[aW]=a0[aS++]^aZ[aV[aW]&255]^N(aZ[(aV[aU[aT]]>>>8)&255],8)^N(aZ[(aV[aU[aT+1]]>>>16)&255],16)^N(aZ[(aV[aU[aT+2]]>>>24)&255],24)}return aX}function az(aS,aT){av=aS;aE=aT;ao(aG(aH(),aF,aD,aq,at))}function aN(aS,aT){av=aS;aE=aT;ao(aG(aH(),aw,aR,au,aB))}return{name:"rijndael",blocksize:128/8,open:an,close:aO,encrypt:az,decrypt:aN}}ad.RIJNDAEL={create:I};function aj(){var aA=null;var au=null;var aw=-1;var ax=null;ax="serpent";var an=[];function az(aH,aF,aE,aJ,aI,aG){aH[aF]^=an[4*aG];aH[aE]^=an[4*aG+1];aH[aJ]^=an[4*aG+2];aH[aI]^=an[4*aG+3]}function aD(aH,aF,aE,aK,aJ,aI,aG){aH[aF]=N(aH[aF],13);aH[aK]=N(aH[aK],3);aH[aE]^=aH[aF];aH[aI]=(aH[aF]<<3)&aa;aH[aJ]^=aH[aK];aH[aE]^=aH[aK];aH[aE]=N(aH[aE],1);aH[aJ]^=aH[aI];aH[aJ]=N(aH[aJ],7);aH[aI]=aH[aE];aH[aF]^=aH[aE];aH[aI]=(aH[aI]<<7)&aa;aH[aK]^=aH[aJ];aH[aF]^=aH[aJ];aH[aK]^=aH[aI];aH[aJ]^=an[4*aG+3];aH[aE]^=an[4*aG+1];aH[aF]=N(aH[aF],5);aH[aK]=N(aH[aK],22);aH[aF]^=an[4*aG+0];aH[aK]^=an[4*aG+2]}function at(aH,aF,aE,aK,aJ,aI,aG){aH[aF]^=an[4*aG+0];aH[aE]^=an[4*aG+1];aH[aK]^=an[4*aG+2];aH[aJ]^=an[4*aG+3];aH[aF]=N(aH[aF],27);aH[aK]=N(aH[aK],10);aH[aI]=aH[aE];aH[aK]^=aH[aJ];aH[aF]^=aH[aJ];aH[aI]=(aH[aI]<<7)&aa;aH[aF]^=aH[aE];aH[aE]=N(aH[aE],31);aH[aK]^=aH[aI];aH[aJ]=N(aH[aJ],25);aH[aI]=(aH[aF]<<3)&aa;aH[aE]^=aH[aF];aH[aJ]^=aH[aI];aH[aF]=N(aH[aF],19);aH[aE]^=aH[aK];aH[aJ]^=aH[aK];aH[aK]=N(aH[aK],29)}var ar=[function(aJ,aI,aH,aG,aF,aE){aJ[aE]=aJ[aF];aJ[aF]|=aJ[aI];aJ[aI]^=aJ[aE];aJ[aE]^=aJ[aG];aJ[aE]=~aJ[aE];aJ[aF]^=aJ[aH];aJ[aH]&=aJ[aI];aJ[aH]^=aJ[aE];aJ[aG]^=aJ[aI];aJ[aI]^=aJ[aF];aJ[aE]|=aJ[aI];aJ[aI]^=aJ[aG];aJ[aG]&=aJ[aH];aJ[aF]^=aJ[aG];aJ[aH]=~aJ[aH];aJ[aG]^=aJ[aE];aJ[aH]^=aJ[aG]},function(aJ,aI,aH,aG,aF,aE){aJ[aE]=aJ[aH];aJ[aH]^=aJ[aI];aJ[aI]^=aJ[aF];aJ[aF]=~aJ[aF];aJ[aE]&=aJ[aH];aJ[aI]|=aJ[aH];aJ[aF]^=aJ[aG];aJ[aI]^=aJ[aF];aJ[aH]^=aJ[aF];aJ[aF]^=aJ[aE];aJ[aH]|=aJ[aE];aJ[aE]^=aJ[aG];aJ[aG]&=aJ[aI];aJ[aG]^=aJ[aH];aJ[aH]|=aJ[aI];aJ[aI]=~aJ[aI];aJ[aI]^=aJ[aG];aJ[aE]^=aJ[aH]},function(aJ,aI,aH,aG,aF,aE){aJ[aF]=~aJ[aF];aJ[aH]^=aJ[aI];aJ[aE]=aJ[aI];aJ[aI]&=aJ[aG];aJ[aI]^=aJ[aF];aJ[aF]|=aJ[aE];aJ[aG]^=aJ[aH];aJ[aF]^=aJ[aH];aJ[aH]&=aJ[aI];aJ[aI]^=aJ[aG];aJ[aG]&=aJ[aF];aJ[aF]|=aJ[aH];aJ[aI]=~aJ[aI];aJ[aF]^=aJ[aI];aJ[aE]^=aJ[aI];aJ[aI]^=aJ[aG];aJ[aH]|=aJ[aG]},function(aJ,aI,aH,aG,aF,aE){aJ[aE]=aJ[aH];aJ[aH]^=aJ[aF];aJ[aF]|=aJ[aI];aJ[aE]&=aJ[aI];aJ[aI]^=aJ[aG];aJ[aG]^=aJ[aH];aJ[aH]&=aJ[aF];aJ[aG]^=aJ[aF];aJ[aI]|=aJ[aE];aJ[aE]^=aJ[aF];aJ[aH]^=aJ[aI];aJ[aI]&=aJ[aF];aJ[aF]&=aJ[aE];aJ[aF]^=aJ[aG];aJ[aE]|=aJ[aH];aJ[aG]&=aJ[aH];aJ[aE]^=aJ[aF];aJ[aI]^=aJ[aF];aJ[aF]^=aJ[aG]},function(aJ,aI,aH,aG,aF,aE){aJ[aE]=aJ[aF];aJ[aF]&=aJ[aI];aJ[aI]^=aJ[aE];aJ[aF]^=aJ[aG];aJ[aG]|=aJ[aE];aJ[aI]^=aJ[aH];aJ[aE]^=aJ[aF];aJ[aG]|=aJ[aI];aJ[aG]^=aJ[aH];aJ[aH]&=aJ[aI];aJ[aH]^=aJ[aE];aJ[aE]&=aJ[aG];aJ[aG]^=aJ[aF];aJ[aE]^=aJ[aI];aJ[aF]|=aJ[aH];aJ[aH]=~aJ[aH];aJ[aF]^=aJ[aI]},function(aJ,aI,aH,aG,aF,aE){aJ[aE]=aJ[aH];aJ[aH]|=aJ[aI];aJ[aG]^=aJ[aH];aJ[aF]=~aJ[aF];aJ[aE]^=aJ[aI];aJ[aI]^=aJ[aG];aJ[aH]&=aJ[aE];aJ[aE]|=aJ[aF];aJ[aE]^=aJ[aI];aJ[aI]&=aJ[aF];aJ[aH]^=aJ[aF];aJ[aF]^=aJ[aG];aJ[aI]^=aJ[aH];aJ[aG]&=aJ[aE];aJ[aH]^=aJ[aG];aJ[aG]&=aJ[aI];aJ[aF]^=aJ[aG]},function(aJ,aI,aH,aG,aF,aE){aJ[aE]=aJ[aH];aJ[aF]^=aJ[aI];aJ[aH]^=aJ[aG];aJ[aG]^=aJ[aI];aJ[aI]&=aJ[aF];aJ[aH]|=aJ[aF];aJ[aE]=~aJ[aE];aJ[aI]^=aJ[aH];aJ[aH]^=aJ[aG];aJ[aF]^=aJ[aE];aJ[aE]^=aJ[aI];aJ[aG]&=aJ[aI];aJ[aE]^=aJ[aH];aJ[aG]^=aJ[aF];aJ[aF]&=aJ[aH];aJ[aF]^=aJ[aI];aJ[aH]^=aJ[aG]},function(aJ,aI,aH,aG,aF,aE){aJ[aH]=~aJ[aH];aJ[aE]=aJ[aH];aJ[aI]=~aJ[aI];aJ[aH]&=aJ[aG];aJ[aH]^=aJ[aF];aJ[aF]|=aJ[aE];aJ[aE]^=aJ[aG];aJ[aG]^=aJ[aF];aJ[aF]^=aJ[aI];aJ[aI]|=aJ[aH];aJ[aG]&=aJ[aI];aJ[aI]^=aJ[aE];aJ[aE]^=aJ[aF];aJ[aF]&=aJ[aI];aJ[aE]^=aJ[aH];aJ[aG]^=aJ[aE];aJ[aF]^=aJ[aH];aJ[aE]|=aJ[aI];aJ[aE]^=aJ[aH]}];var ay=[function(aJ,aI,aH,aG,aF,aE){aJ[aE]=aJ[aF];aJ[aH]^=aJ[aI];aJ[aF]|=aJ[aH];aJ[aE]^=aJ[aH];aJ[aI]=~aJ[aI];aJ[aG]^=aJ[aF];aJ[aF]^=aJ[aI];aJ[aI]&=aJ[aH];aJ[aI]^=aJ[aG];aJ[aG]&=aJ[aF];aJ[aF]^=aJ[aE];aJ[aG]^=aJ[aF];aJ[aH]^=aJ[aF];aJ[aF]&=aJ[aI];aJ[aH]^=aJ[aI];aJ[aI]^=aJ[aG];aJ[aE]^=aJ[aF]},function(aJ,aI,aH,aG,aF,aE){aJ[aH]^=aJ[aF];aJ[aE]=aJ[aI];aJ[aI]^=aJ[aG];aJ[aG]=~aJ[aG];aJ[aE]|=aJ[aH];aJ[aE]^=aJ[aF];aJ[aF]&=aJ[aH];aJ[aH]^=aJ[aG];aJ[aG]&=aJ[aE];aJ[aE]^=aJ[aH];aJ[aH]|=aJ[aF];aJ[aF]^=aJ[aI];aJ[aG]^=aJ[aI];aJ[aI]|=aJ[aE];aJ[aG]^=aJ[aE];aJ[aH]^=aJ[aI];aJ[aE]^=aJ[aH]},function(aJ,aI,aH,aG,aF,aE){aJ[aG]^=aJ[aH];aJ[aE]=aJ[aF];aJ[aF]=~aJ[aF];aJ[aF]|=aJ[aG];aJ[aG]^=aJ[aE];aJ[aE]^=aJ[aI];aJ[aF]^=aJ[aH];aJ[aH]|=aJ[aG];aJ[aG]^=aJ[aI];aJ[aH]^=aJ[aE];aJ[aE]|=aJ[aF];aJ[aG]^=aJ[aF];aJ[aE]^=aJ[aG];aJ[aG]&=aJ[aH];aJ[aG]^=aJ[aF];aJ[aF]^=aJ[aE];aJ[aE]^=aJ[aI]},function(aJ,aI,aH,aG,aF,aE){aJ[aG]^=aJ[aH];aJ[aE]=aJ[aH];aJ[aH]&=aJ[aG];aJ[aH]^=aJ[aI];aJ[aI]|=aJ[aE];aJ[aE]^=aJ[aF];aJ[aI]^=aJ[aF];aJ[aF]|=aJ[aH];aJ[aH]^=aJ[aG];aJ[aH]^=aJ[aF];aJ[aI]^=aJ[aG];aJ[aG]^=aJ[aF];aJ[aF]&=aJ[aH];aJ[aH]^=aJ[aI];aJ[aI]&=aJ[aG];aJ[aE]^=aJ[aF];aJ[aF]^=aJ[aI];aJ[aI]^=aJ[aH]},function(aJ,aI,aH,aG,aF,aE){aJ[aG]^=aJ[aF];aJ[aE]=aJ[aI];aJ[aI]&=aJ[aH];aJ[aI]^=aJ[aG];aJ[aG]|=aJ[aF];aJ[aE]=~aJ[aE];aJ[aH]^=aJ[aI];aJ[aI]^=aJ[aG];aJ[aG]&=aJ[aE];aJ[aG]^=aJ[aI];aJ[aI]|=aJ[aE];aJ[aI]^=aJ[aF];aJ[aF]&=aJ[aG];aJ[aE]^=aJ[aF];aJ[aF]^=aJ[aH];aJ[aH]&=aJ[aI];aJ[aE]^=aJ[aH];aJ[aI]^=aJ[aF]},function(aJ,aI,aH,aG,aF,aE){aJ[aE]=aJ[aH];aJ[aH]|=aJ[aG];aJ[aG]^=aJ[aE];aJ[aH]^=aJ[aF];aJ[aF]&=aJ[aE];aJ[aG]^=aJ[aF];aJ[aF]|=aJ[aI];aJ[aI]=~aJ[aI];aJ[aF]^=aJ[aG];aJ[aG]|=aJ[aI];aJ[aE]^=aJ[aH];aJ[aG]^=aJ[aE];aJ[aE]&=aJ[aI];aJ[aI]^=aJ[aH];aJ[aH]^=aJ[aF];aJ[aI]&=aJ[aG];aJ[aG]^=aJ[aF];aJ[aI]^=aJ[aG];aJ[aG]^=aJ[aE];aJ[aE]^=aJ[aF]},function(aJ,aI,aH,aG,aF,aE){aJ[aI]^=aJ[aG];aJ[aE]=aJ[aI];aJ[aI]&=aJ[aF];aJ[aG]^=aJ[aF];aJ[aI]^=aJ[aG];aJ[aF]^=aJ[aH];aJ[aG]|=aJ[aE];aJ[aG]^=aJ[aF];aJ[aF]&=aJ[aI];aJ[aI]=~aJ[aI];aJ[aF]^=aJ[aH];aJ[aH]&=aJ[aG];aJ[aE]^=aJ[aI];aJ[aF]^=aJ[aE];aJ[aE]^=aJ[aG];aJ[aI]^=aJ[aH];aJ[aG]^=aJ[aI]},function(aJ,aI,aH,aG,aF,aE){aJ[aE]=aJ[aF];aJ[aF]&=aJ[aI];aJ[aI]^=aJ[aG];aJ[aG]|=aJ[aE];aJ[aE]^=aJ[aH];aJ[aI]=~aJ[aI];aJ[aH]|=aJ[aF];aJ[aE]^=aJ[aI];aJ[aI]&=aJ[aG];aJ[aI]^=aJ[aH];aJ[aH]&=aJ[aG];aJ[aF]^=aJ[aG];aJ[aE]^=aJ[aF];aJ[aG]&=aJ[aF];aJ[aF]|=aJ[aI];aJ[aH]^=aJ[aE];aJ[aF]^=aJ[aE];aJ[aE]&=aJ[aI];aJ[aE]^=aJ[aG]}];var aq=[7788,63716,84032,7891,78949,25146,28835,67288,84032,40055,7361,1940,77639,27525,24193,75702,7361,35413,83150,82383,58619,48468,18242,66861,83150,69667,7788,31552,40054,23222,52496,57565,7788,63716];var av=[44255,61867,45034,52496,73087,56255,43827,41448,18242,1939,18581,56255,64584,31097,26469,77728,77639,4216,64585,31097,66861,78949,58006,59943,49676,78950,5512,78949,27525,52496,18670,76143];var aC=[44255,60896,28835,1837,1057,4216,18242,77301,47399,53992,1939,1940,66420,39172,78950,45917,82383,7450,67288,26469,83149,57565,66419,47400,58006,44254,18581,18228,33048,45034,66508,7449];function am(aM){aA=aM;var aK,aI,aH,aF;function aG(aO,aN,aR,aQ,aP){an[aP]=aE[aN]=N(an[aO]^aE[aN]^aE[aR]^aE[aQ]^2654435769^aP,11)}function aL(aO,aN,aR,aQ,aP){aE[aO]=an[aP];aE[aN]=an[aP+1];aE[aR]=an[aP+2];aE[aQ]=an[aP+3]}function aJ(aO,aN,aR,aQ,aP){an[aP]=aE[aO];an[aP+1]=aE[aN];an[aP+2]=aE[aR];an[aP+3]=aE[aQ]}aA.reverse();aA[aA.length]=1;while(aA.length<32){aA[aA.length]=0}for(aK=0;aK<8;aK++){an[aK]=(aA[4*aK+0]&255)|(aA[4*aK+1]&255)<<8|(aA[4*aK+2]&255)<<16|(aA[4*aK+3]&255)<<24}var aE=[an[3],an[4],an[5],an[6],an[7]];aK=0;aI=0;while(aG(aI++,0,4,2,aK++),aG(aI++,1,0,3,aK++),aK<132){aG(aI++,2,1,4,aK++);if(aK==8){aI=0}aG(aI++,3,2,0,aK++);aG(aI++,4,3,1,aK++)}aK=128;aI=3;aF=0;while(aH=aq[aF++],ar[aI++%8](aE,aH%5,aH%7,aH%11,aH%13,aH%17),aH=aq[aF],aJ(aH%5,aH%7,aH%11,aH%13,aK),aK>0){aK-=4;aL(aH%5,aH%7,aH%11,aH%13,aK)}}function ap(){an=[]}function aB(aI,aJ){au=aI;aw=aJ;var aF=au.slice(aw,aw+16);aF.reverse();var aH=[ah(aF,0),ah(aF,4),ah(aF,8),ah(aF,12)];az(aH,0,1,2,3,0);var aK=0,aE=av[aK];while(ar[aK%8](aH,aE%5,aE%7,aE%11,aE%13,aE%17),aK<31){aE=av[++aK];aD(aH,aE%5,aE%7,aE%11,aE%13,aE%17,aK)}az(aH,0,1,2,3,32);for(var aG=3;aG>=0;aG--,aw+=4){K(au,aw,aH[aG])}}function ao(aH,aI){au=aH;aw=aI;var aF=au.slice(aw,aw+16);aF.reverse();var aG=[ah(aF,0),ah(aF,4),ah(aF,8),ah(aF,12)];az(aG,0,1,2,3,32);var aJ=0,aE=aC[aJ];while(ay[7-aJ%8](aG,aE%5,aE%7,aE%11,aE%13,aE%17),aJ<31){aE=aC[++aJ];at(aG,aE%5,aE%7,aE%11,aE%13,aE%17,32-aJ)}az(aG,2,3,1,4,0);K(au,aw,aG[4]);K(au,aw+4,aG[1]);K(au,aw+8,aG[3]);K(au,aw+12,aG[2]);aw+=16}return{name:"serpent",blocksize:128/8,open:am,close:ap,encrypt:aB,decrypt:ao}}ad.SERPENT={create:aj};function Q(){var aw=null;var ao=null;var aq=-1;var at=null;at="twofish";var az=[];var ax=[[],[],[],[]];function ay(a1){aw=a1;var aV,a0,aZ,aX,aW,aO=[],aE=[],aM=[];var aB;var aJ=[];var aT,aH,aQ;var aL=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]];var aK=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]];var aI=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]];var aG=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]];var aD=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15];var aY=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7];var aN=[[],[]];var aR=[[],[],[],[]];function aF(a2){return a2^(a2>>2)^[0,90,180,238][a2&3]}function aU(a2){return a2^(a2>>1)^(a2>>2)^[0,238,180,90][a2&3]}function aP(a6,a5){var a4,a3,a2;for(a4=0;a4<8;a4++){a3=a5>>>24;a5=((a5<<8)&aa)|a6>>>24;a6=(a6<<8)&aa;a2=a3<<1;if(a3&128){a2^=333}a5^=a3^(a2<<16);a2^=a3>>>1;if(a3&1){a2^=166}a5^=a2<<24|a2<<8}return a5}function aC(a7,a3){var a4,a2,a6,a5;a4=a3>>4;a2=a3&15;a6=aL[a7][a4^a2];a5=aK[a7][aD[a2]^aY[a4]];return aG[a7][aD[a5]^aY[a6]]<<4|aI[a7][a6^a5]}function aS(a3,a5){var a4=L(a3,0),a2=L(a3,1),a7=L(a3,2),a6=L(a3,3);switch(aB){case 4:a4=aN[1][a4]^L(a5[3],0);a2=aN[0][a2]^L(a5[3],1);a7=aN[0][a7]^L(a5[3],2);a6=aN[1][a6]^L(a5[3],3);case 3:a4=aN[1][a4]^L(a5[2],0);a2=aN[1][a2]^L(a5[2],1);a7=aN[0][a7]^L(a5[2],2);a6=aN[0][a6]^L(a5[2],3);case 2:a4=aN[0][aN[0][a4]^L(a5[1],0)]^L(a5[0],0);a2=aN[0][aN[1][a2]^L(a5[1],1)]^L(a5[0],1);a7=aN[1][aN[0][a7]^L(a5[1],2)]^L(a5[0],2);a6=aN[1][aN[1][a6]^L(a5[1],3)]^L(a5[0],3)}return aR[0][a4]^aR[1][a2]^aR[2][a7]^aR[3][a6]}aw=aw.slice(0,32);aV=aw.length;while(aV!=16&&aV!=24&&aV!=32){aw[aV++]=0}for(aV=0;aV<aw.length;aV+=4){aM[aV>>2]=ah(aw,aV)}for(aV=0;aV<256;aV++){aN[0][aV]=aC(0,aV);aN[1][aV]=aC(1,aV)}for(aV=0;aV<256;aV++){aT=aN[1][aV];aH=aF(aT);aQ=aU(aT);aR[0][aV]=aT+(aH<<8)+(aQ<<16)+(aQ<<24);aR[2][aV]=aH+(aQ<<8)+(aT<<16)+(aQ<<24);aT=aN[0][aV];aH=aF(aT);aQ=aU(aT);aR[1][aV]=aQ+(aQ<<8)+(aH<<16)+(aT<<24);aR[3][aV]=aH+(aT<<8)+(aQ<<16)+(aH<<24)}aB=aM.length/2;for(aV=0;aV<aB;aV++){a0=aM[aV+aV];aO[aV]=a0;aZ=aM[aV+aV+1];aE[aV]=aZ;aJ[aB-aV-1]=aP(a0,aZ)}for(aV=0;aV<40;aV+=2){a0=16843009*aV;aZ=a0+16843009;a0=aS(a0,aO);aZ=N(aS(aZ,aE),8);az[aV]=(a0+aZ)&aa;az[aV+1]=N(a0+2*aZ,9)}for(aV=0;aV<256;aV++){a0=aZ=aX=aW=aV;switch(aB){case 4:a0=aN[1][a0]^L(aJ[3],0);aZ=aN[0][aZ]^L(aJ[3],1);aX=aN[0][aX]^L(aJ[3],2);aW=aN[1][aW]^L(aJ[3],3);case 3:a0=aN[1][a0]^L(aJ[2],0);aZ=aN[1][aZ]^L(aJ[2],1);aX=aN[0][aX]^L(aJ[2],2);aW=aN[0][aW]^L(aJ[2],3);case 2:ax[0][aV]=aR[0][aN[0][aN[0][a0]^L(aJ[1],0)]^L(aJ[0],0)];ax[1][aV]=aR[1][aN[0][aN[1][aZ]^L(aJ[1],1)]^L(aJ[0],1)];ax[2][aV]=aR[2][aN[1][aN[0][aX]^L(aJ[1],2)]^L(aJ[0],2)];ax[3][aV]=aR[3][aN[1][aN[1][aW]^L(aJ[1],3)]^L(aJ[0],3)]}}}function av(aB){return ax[0][L(aB,0)]^ax[1][L(aB,1)]^ax[2][L(aB,2)]^ax[3][L(aB,3)]}function au(aB){return ax[0][L(aB,3)]^ax[1][L(aB,0)]^ax[2][L(aB,1)]^ax[3][L(aB,2)]}function an(aE,aD){var aC=av(aD[0]);var aB=au(aD[1]);aD[2]=N(aD[2]^(aC+aB+az[4*aE+8])&aa,31);aD[3]=N(aD[3],1)^(aC+2*aB+az[4*aE+9])&aa;aC=av(aD[2]);aB=au(aD[3]);aD[0]=N(aD[0]^(aC+aB+az[4*aE+10])&aa,31);aD[1]=N(aD[1],1)^(aC+2*aB+az[4*aE+11])&aa}function ap(aE,aD){var aC=av(aD[0]);var aB=au(aD[1]);aD[2]=N(aD[2],1)^(aC+aB+az[4*aE+10])&aa;aD[3]=N(aD[3]^(aC+2*aB+az[4*aE+11])&aa,31);aC=av(aD[2]);aB=au(aD[3]);aD[0]=N(aD[0],1)^(aC+aB+az[4*aE+8])&aa;aD[1]=N(aD[1]^(aC+2*aB+az[4*aE+9])&aa,31)}function ar(){az=[];ax=[[],[],[],[]]}function am(aD,aE){ao=aD;aq=aE;var aB=[ah(ao,aq)^az[0],ah(ao,aq+4)^az[1],ah(ao,aq+8)^az[2],ah(ao,aq+12)^az[3]];for(var aC=0;aC<8;aC++){an(aC,aB)}Z(ao,aq,aB[2]^az[4]);Z(ao,aq+4,aB[3]^az[5]);Z(ao,aq+8,aB[0]^az[6]);Z(ao,aq+12,aB[1]^az[7]);aq+=16}function aA(aD,aE){ao=aD;aq=aE;var aB=[ah(ao,aq)^az[4],ah(ao,aq+4)^az[5],ah(ao,aq+8)^az[6],ah(ao,aq+12)^az[7]];for(var aC=7;aC>=0;aC--){ap(aC,aB)}Z(ao,aq,aB[2]^az[0]);Z(ao,aq+4,aB[3]^az[1]);Z(ao,aq+8,aB[0]^az[2]);Z(ao,aq+12,aB[1]^az[3]);aq+=16}return{name:"twofish",blocksize:128/8,open:ay,close:ar,encrypt:am,decrypt:aA}}ad.TWOFISH={create:Q};var X={};function G(){function ar(){this.algorithm.open(this.keyBytes);this.dataLength=this.dataBytes.length;this.dataOffset=0;return}function aq(){this.algorithm.close()}function ao(){this.algorithm.encrypt(this.dataBytes,this.dataOffset);this.dataOffset+=this.algorithm.blocksize;if(this.dataLength<=this.dataOffset){return 0}else{return this.dataLength-this.dataOffset}}function an(){this.algorithm.open(this.keyBytes);this.dataLength=this.dataBytes.length;this.dataOffset=0;return}function am(){this.algorithm.decrypt(this.dataBytes,this.dataOffset);this.dataOffset+=this.algorithm.blocksize;if(this.dataLength<=this.dataOffset){return 0}else{return this.dataLength-this.dataOffset}}function ap(){this.algorithm.close();while(this.dataBytes[this.dataBytes.length-1]==0){this.dataBytes.pop()}}return{encrypt:{open:ar,exec:ao,close:aq},decrypt:{open:an,exec:am,close:ap}}}X.ECB=G();function V(){function aq(){this.algorithm.open(this.keyBytes);this.dataBytes.unshift(R(),R(),R(),R(),R(),R(),R(),R(),R(),R(),R(),R(),R(),R(),R(),R());this.dataLength=this.dataBytes.length;this.dataOffset=16;return}function an(){for(var at=this.dataOffset;at<this.dataOffset+16;at++){this.dataBytes[at]^=this.dataBytes[at-16]}this.algorithm.encrypt(this.dataBytes,this.dataOffset);this.dataOffset+=this.algorithm.blocksize;if(this.dataLength<=this.dataOffset){return 0}else{return this.dataLength-this.dataOffset}}function ap(){this.algorithm.close()}function am(){this.algorithm.open(this.keyBytes);this.dataLength=this.dataBytes.length;this.dataOffset=16;this.iv=this.dataBytes.slice(0,16);return}function ar(){var au=this.dataBytes.slice(this.dataOffset,this.dataOffset+16);this.algorithm.decrypt(this.dataBytes,this.dataOffset);for(var at=0;at<16;at++){this.dataBytes[this.dataOffset+at]^=this.iv[at]}this.dataOffset+=this.algorithm.blocksize;this.iv=au;if(this.dataLength<=this.dataOffset){return 0}else{return this.dataLength-this.dataOffset}}function ao(){this.algorithm.close();this.dataBytes.splice(0,16);while(this.dataBytes[this.dataBytes.length-1]==0){this.dataBytes.pop()}}return{encrypt:{open:aq,exec:an,close:ap},decrypt:{open:am,exec:ar,close:ao}}}X.CBC=V();function al(){function ao(){throw"not implemented!"}function ar(){throw"not implemented!"}function an(){throw"not implemented!"}function aq(){throw"not implemented!"}function ap(){throw"not implemented!"}function am(){throw"not implemented!"}return{encrypt:{open:ao,exec:ar,close:an},decrypt:{open:aq,exec:ap,close:am}}}X.CFB=al();function W(){function aq(){throw"not implemented!"}function an(){throw"not implemented!"}function ap(){throw"not implemented!"}function am(){throw"not implemented!"}function ar(){throw"not implemented!"}function ao(){throw"not implemented!"}return{encrypt:{open:aq,exec:an,close:ap},decrypt:{open:am,exec:ar,close:ao}}}X.OFB=W();function P(){function ao(){throw"not implemented!"}function ar(){throw"not implemented!"}function an(){throw"not implemented!"}function aq(){throw"not implemented!"}function ap(){throw"not implemented!"}function am(){throw"not implemented!"}return{encrypt:{open:ao,exec:ar,close:an},decrypt:{open:aq,exec:ap,close:am}}}X.CTR=P();var ag={};function ak(){function am(aq){var ao=16-(aq.length%16);aq.push(128);for(var ap=1;ap<ao;ap++){aq.push(0)}return aq}function an(ap){for(var ao=ap.length-1;0<=ao;ao--){var aq=ap[ao];if(aq==128){ap.splice(ao);break}else{if(aq!=0){break}}}return ap}return{append:am,remove:an}}ag.RFC1321=ak();function ab(){function an(aq){var ao=16-(aq.length%16);for(var ap=0;ap<ao-1;ap++){aq.push(0)}aq.push(ao);return aq}function am(aq){var ao=aq.pop();if(16<ao){ao=16}for(var ap=1;ap<ao;ap++){aq.pop()}return aq}return{append:an,remove:am}}ag.ANSIX923=ab();function F(){function an(aq){var ao=16-(aq.length%16);for(var ap=0;ap<ao-1;ap++){aq.push(R())}aq.push(ao);return aq}function am(aq){var ao=aq.pop();if(16<ao){ao=16}for(var ap=1;ap<ao;ap++){aq.pop()}return aq}return{append:an,remove:am}}ag.ISO10126=F();function af(){function an(aq){var ao=16-(aq.length%16);for(var ap=0;ap<ao;ap++){aq.push(ao)}return aq}function am(aq){var ao=aq.pop();if(16<ao){ao=0}for(var ap=1;ap<ao;ap++){aq.pop()}return aq}return{append:an,remove:am}}ag.PKCS7=af();function H(){function an(ao){return ao}function am(ao){return ao}return{append:an,remove:am}}ag.NO_PADDING=H();var Y={ENCRYPT:"encrypt",DECRYPT:"decrypt"};function S(am,ao,ap,an){this.algorithm=am;this.direction=ao;this.mode=ap;this.padding=an;this.modeOpen=ap[ao].open;this.modeExec=ap[ao].exec;this.modeClose=ap[ao].close;this.keyBytes=null;this.dataBytes=null;this.dataOffset=-1;this.dataLength=-1}S.prototype=new Object();S.prototype.inherit=S;function T(an,am){if(an==null){throw"keyBytes is null"}if(am==null){throw"dataBytes is null"}this.keyBytes=an.concat();this.dataBytes=am;this.dataOffset=0;this.dataLength=am.length;if(this.direction==Y.ENCRYPT){this.padding.append(this.dataBytes)}this.modeOpen()}function ai(){return this.modeExec()}function U(){this.modeClose();if(this.direction==Y.DECRYPT){this.padding.remove(this.dataBytes)}return this.dataBytes}function O(an,am){this.open(an,am);for(;;){var ao=this.operate();if(0<ao){continue}else{break}}return this.close()}S.prototype.open=T;S.prototype.close=U;S.prototype.operate=ai;S.prototype.execute=O;S.ENCRYPT="ENCRYPT";S.DECRYPT="DECRYPT";S.RIJNDAEL="RIJNDAEL";S.SERPENT="SERPENT";S.TWOFISH="TWOFISH";S.ECB="ECB";S.CBC="CBC";S.CFB="CFB";S.OFB="OFB";S.CTR="CTR";S.RFC1321="RFC1321";S.ANSIX923="ANSIX923";S.ISO10126="ISO10126";S.PKCS7="PKCS7";S.NO_PADDING="NO_PADDING";S.create=function(ao,an,au,at){if(ao==null){ao=S.RIJNDAEL}if(an==null){an=S.ENCRYPT}if(au==null){au=S.CBC}if(at==null){at=S.PKCS7}var am=ad[ao];var aq=Y[an];var ar=X[au];var ap=ag[at];if(am==null){throw"Invalid algorithm name '"+ao+"'."}if(aq==null){throw"Invalid direction name '"+an+"'."}if(ar==null){throw"Invalid mode name '"+au+"'."}if(ap==null){throw"Invalid padding name '"+at+"'."}return new S(am.create(),aq,ar,ap)};S.algorithm=function(an){if(an==null){throw"Null Pointer Exception ( algorithmName )"}var am=ad[an];if(am==null){throw"Invalid algorithm name '"+an+"'."}return am.create()};s(M,"titaniumcore.crypto.Cipher",S)}E(this);function d(L){w("SOAEP.js");f("packages.js");f("binary.js");f("Cipher.js");f("SecureRandom.js");var G=o(L,"titaniumcore.crypto.SecureRandom");var K=o(L,"titaniumcore.crypto.Cipher");function N(O,P,Q){if(Q==null){Q=true}this.random=O==null?new G():O;this.cipherAlgorithm=P==null?K.algorithm(K.TWOFISH):P;this.withBitPadding=Q}function J(O){var P=this.cipherAlgorithm.blocksize;return O-P+(this.withBitPadding?-1:0)}function M(Y,P){var R=this.cipherAlgorithm.blocksize;if(P==null){P=Math.ceil((1+Y.length)/R)*R+R}if(0!=(P%R)){throw"SOAEP.encode() error : length("+P+") must be a multiple of "+R+" since the block size of "+this.cipherAlgorithm.name+" is "+R}var aa=Math.floor(P/R);var W=this.maxsize(P);if(W<Y.length){throw"SOAEP.encode() error : the size of input data ("+Y.length+" bytes) must not exceed "+W+"byte. \n"+W+"(maxsize)="+P+"(bit-length of the RSA key )-"+R+"( blocksize of the cipher algorithm)"+(this.withBitPadding?"-1(size of the terminator byte)":"")}var Q=new Array(P);var X=new Array(R);this.random.nextBytes(X);for(var V=0;V<Y.length;V++){Q[V]=Y[V]}if(this.withBitPadding){Q[Y.length]=128;for(var V=Y.length+1;V<P-R;V++){Q[V]=0}}else{for(var V=Y.length;V<P-R;V++){Q[V]=0}}for(var V=P-R,U=0;V<P;V++,U++){Q[V]=X[U]}var S=X.concat();this.cipherAlgorithm.open(X);for(var Z=aa-2;0<=Z;Z--){var T=Z*R;for(var V=T,U=0;U<R;V++,U++){Q[V]^=S[U]}this.cipherAlgorithm.encrypt(Q,T);S=Q.slice(T,T+R)}this.cipherAlgorithm.close();var O=Q.slice(0,R);S=O;this.cipherAlgorithm.open(O);for(var Z=1;Z<aa;Z++){var T=Z*R;for(var V=T,U=0;U<R;V++,U++){Q[V]^=S[U]}this.cipherAlgorithm.encrypt(Q,T);S=Q.slice(T,T+R)}this.cipherAlgorithm.close();return Q}function F(Z){var Q=Z.length;var S=this.cipherAlgorithm.blocksize;if(0!=Q%S){throw"SOAEP.decode() error : length "+Q+" must be a multiple of "+S}var ab=Math.floor(Q/S);var R=Z.concat();var P=R.slice(0,S);var T=P;this.cipherAlgorithm.open(P);for(var aa=1;aa<ab;aa++){var V=aa*S;var Y=R.slice(V,V+S);this.cipherAlgorithm.decrypt(R,V);for(var W=V,U=0;U<S;W++,U++){R[W]^=T[U]}T=Y}var O=(ab-1)*S;var X=R.slice(O,O+S);var T=X;this.cipherAlgorithm.open(X);for(var aa=ab-2;0<=aa;aa--){var V=aa*S;var Y=R.slice(V,V+S);this.cipherAlgorithm.decrypt(R,V);for(var W=V,U=0;U<S;W++,U++){R[W]^=T[U]}T=Y}this.cipherAlgorithm.close();if(this.withBitPadding){for(var W=O-1;0<=W;W--){if(R[W]==128){R=R.slice(0,W);break}else{if(R[W]==0){}else{throw"decode() : found illegal character 0x"+R[W].toString(16).toUpperCase()}}}}else{R=R.slice(0,O)}return R}function H(){return this.cipherAlgorithm.blocksize}N.prototype.encode=M;N.prototype.decode=F;N.prototype.maxsize=J;N.prototype.blocksize=H;function I(O,P,Q){return new N(O,P,Q)}N.create=I;s(L,"titaniumcore.crypto.SOAEP",N)}d(this);function t(N){w("RSAKeyFormat.js");f("packages.js");f("BigInteger.init1.js");f("binary.js");f("SOAEP.js");var I=o(N,"titaniumcore.crypto.BigInteger");var P=o(N,"titaniumcore.crypto.SOAEP");var R=function(U){var T=0;return{read_block:function(){var V=ba2i(U.slice(T,T+4));T+=4;if(U.length<T+V){throw"Array Index Out of Bounds Exception("+(T+V)+")"}var W=U.slice(T,T+V);T+=V;return W},read:function(){var V=ba2i(U.slice(T,T+4));T+=4;return V}}};function F(T){if(T.className=="BigInteger"){return T}else{return new I(T)}}function K(T){return P.create().encode(T)}function S(T){return P.create().decode(T)}function O(V){var T="";for(var U=0;U<V.length;U++){var W=V.charAt(U);if(W==" "||W=="\t"||W=="\r"||W=="\n"){}else{T+=W}}return T}function H(T){if(typeof T=="string"){return base64x_decode(O(T))}else{return T}}function M(Y,X,W){var V=F(Y).toByteArray();var U=F(X).toByteArray();var T=[];T=T.concat(i2ba(W));T=T.concat(i2ba(V.length));T=T.concat(V);T=T.concat(i2ba(U.length));T=T.concat(U);T=K(T);return T}function J(aa,Y,Z,X){var W=F(aa).toByteArray();var U=F(Y).toByteArray();var V=F(Z).toByteArray();var T=[];T=T.concat(i2ba(X));T=T.concat(i2ba(W.length));T=T.concat(W);T=T.concat(i2ba(U.length));T=T.concat(U);T=T.concat(i2ba(V.length));T=T.concat(V);T=K(T);return T}function Q(U){U=H(U);U=S(U);var T=R(U);var W=T.read();var X=T.read_block();var V=T.read_block();return{ksize:W,n:X,e:V}}function G(U){U=H(U);U=S(U);var T=R(U);var W=T.read();var Y=T.read_block();var V=T.read_block();var X=T.read_block();return{ksize:W,n:Y,e:V,d:X}}function L(){}L.encodePublicKey=M;L.encodePrivateKey=J;L.decodePublicKey=Q;L.decodePrivateKey=G;s(N,"titaniumcore.crypto.RSAKeyFormat",L)}t(this);function q(L){w("BitPadding.js");f("packages.js");function F(){}function G(M){return M-1}function I(O,Q){if(Q==null){Q=O.length+1}var N=Q-1;if(N<O.length){throw"the size of input data ("+O.length+" bytes) must not exceed "+N+"byte. \n"+N+"(maxsize)="+Q+"(bit-length of the RSA key )-1(size of the terminator byte)"}var M=new Array(Q);for(var P=0;P<O.length;P++){M[P]=O[P]}M[O.length]=128;for(var P=O.length+1;P<Q;P++){M[P]=0}return M}function K(N){var P=N.length;var M=N.concat();for(var O=M.length-1;0<=O;O--){if(M[O]==128){M=M.slice(0,O);break}else{if(M[O]==0){}else{throw"decode() : found illegal character 0x"+M[O].toString(16).toUpperCase()}}}return M}function J(){return 1}F.prototype.encode=I;F.prototype.decode=K;F.prototype.maxsize=G;F.prototype.blocksize=J;function H(){return new F()}F.create=H;s(L,"titaniumcore.crypto.BitPadding",F)}q(this);return this}}(window));