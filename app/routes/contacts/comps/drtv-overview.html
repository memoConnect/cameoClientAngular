<cm-header cm-rubber-space>
    <cm-identity cm-weight="4"></cm-identity>
    <cm-add-button cm-weight="1" ng-click="createNewConversation()" data-qa="new-conversation-btn" cm-icon="new-talk"></cm-add-button>
    <cm-add-button cm-weight="1" ng-click="openModal('add-contact')" data-qa="add-contact-btn" cm-icon="new-contact"></cm-add-button>
    <cm-header-list-search cm-weight="1" ng-model="search"></cm-header-list-search>
    <cm-menu cm-weight="1"></cm-menu>
</cm-header>

<cm-modal-add-contact id="add-contact" nose-position="6rem"></cm-modal-add-contact>

<cm-contacts-list contacts-as="contacts">
    <div ng-show="isLoading" class="empty-list">
        <cm-spinner></cm-spinner>
    </div>

    <div ng-show="!contacts.length && !isLoading" class="empty-list">
        <i class="fa cm-info"></i> {{"CONTACTS.LIST_EMPTY"|cmTranslate}}
    </div>

    <cm-contact-tag
        ng-repeat="contact in contacts | cmSearch:'contacts':search | cmPendingFirst"
        cm-rubber-space
        ng-class="{'disabled':contact.contactType == 'pending'}">
        <cm-avatar cm-data="contact.identity" ng-click="editContact(contact)"></cm-avatar>
        <div>
            <cm-key-level cm-data="contact.identity.keys.getWeakestKeySize()"></cm-key-level>
            <i ng-if = "isTrusted(contact)" class="fa cm-handshake"></i>
        </div>
        <cm-contact-brief cm-data="contact" cm-weight="1" ng-click="editContact(contact)"></cm-contact-brief>
        <cm-contact-type cm-data="contact"></cm-contact-type>
        <span class="separator"></span>
        <button ng-click="startConversation(contact)" data-qa="start-new-conversation-btn" ng-hide="contact.contactType == 'pending'">
            <i class="fa cm-new-talk"></i>
        </button>
    </cm-contact-tag>
</cm-contacts-list>