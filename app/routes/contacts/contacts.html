<cm-header cm-rubber-space>
    <cm-back     cm-weight="1" back-to="/talks"></cm-back>
    <cm-identity cm-weight="10"></cm-identity>
    <cm-logo     cm-weight="8"></cm-logo>
    <cm-reload   cm-weight="8"></cm-reload>
    <cm-menu     cm-weight="2"></cm-menu>
</cm-header>

<section ng-controller="ContactsCtrl">
    <!-- contact list -->
    <div ng-if="activeSection == 'list'">
        <header class="cm-list-header">
            <h1>{{'CONTACTS.HEADING.LIST'|cmTranslate}}</h1>

            <button ng-click="openAddModal()" cm-edge data-qa="add-contact-btn">
                <i class="fa cm-edge-add"></i>
            </button>

            <input type="text" value="" ng-model="search" cm-icon="cm-search" cm-large-input />
        </header>

        <cm-contacts-filter-controls sort-by="" filter-by=""></cm-contacts-filter-controls>

        <cm-contacts-list contacts-as="contacts">
            <div ng-show="isLoading" class="empty-list">
                <cm-spinner ></cm-spinner>
            </div>

            <div ng-show="!contacts.length && !isLoading" class="empty-list">
                <i class="fa cm-info"></i> {{"CONTACTS.LIST_EMPTY"|cmTranslate}}
            </div>

            <cm-contact-tag cm-rubber-space ng-repeat="contact in contacts | filter:search">
                <cm-avatar cm-data="contact.identity" ng-click="editContact(contact)"></cm-avatar>
                <cm-key-level key-size="contact.identity.getWeakestKeySize()"></cm-key-level>
                <cm-contact-brief cm-data="contact" cm-weight="1" ng-click="editContact(contact)"></cm-contact-brief>
                <cm-contact-type cm-data="contact"></cm-contact-type>
                <span class="separator"></span>
                <button ng-click="startConversation(contact)" data-qa="start-new-conversation-btn">
                    <i class="fa cm-write"></i>
                </button>
            </cm-contact-tag>

        </cm-contacts-list>
    </div>
    <!-- request list -->
    <div ng-if="activeSection == 'requests'">
        <cm-contact-request-list>

            <header>
                <i class="fa cm-contacts cm-lg-icon"></i> {{'CONTACTS.HEADING.REQUESTS'|cmTranslate}}
            </header>

            <div ng-show="isLoading" class="empty-list">
                <cm-spinner ></cm-spinner>
            </div>

            <div ng-show="!requests.length && !isLoading" class="empty-list">
                <i class="fa cm-info"></i> {{'CONTACTS.INFO.NO_REQUESTS'|cmTranslate}}
            </div>

            <cm-contact-tag cm-rubber-space ng-repeat="request in requests" ng-class="{'is-new':request.state == undefined,'message-open':request.isOpen}">
                <cm-avatar cm-data="request.identity"></cm-avatar>
                <div class="cm-request-brief" cm-weight="1" ng-click="toggleBrief(request)" ng-class="{'with-message':request.message != ''}">
                    <strong>{{request.identity.getDisplayName()}}</strong><br />
                    {{request.message}}
                </div>
                <button ng-click="acceptRequest(request)">
                    <i class="fa cm-checkbox"></i>
                </button>
            </cm-contact-tag>
        </cm-contact-request-list>
    </div>
    <!-- search identity -->
    <div cm-search-cameo-identity ng-if="activeSection == 'search'">


    </div>

</section>

<cm-footer cm-rubber-space></cm-footer>