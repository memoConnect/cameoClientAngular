<section>
	<div class="cm-tools">		
		<i
			class	 = "fa fa-plus-square" 			
			style	 = "cursor:pointer"
			ng-click = "show_contacts = !show_contacts"
			ng-hide	 = "show_contacts"
		>
		</i>

		<i
			class	 = "fa fa-minus-square" 			
			style	 = "cursor:pointer"
			ng-click = "show_contacts = !show_contacts"
			ng-show	 = "show_contacts"
		>
		</i>

		{{'CONVERSATION.TAG.RECIPIENTS' |cmTranslate}}:

		<span ng-repeat = "recipient in conversation.recipients">
			{{recipient.displayName}}
			<i
				class		= "fa fa-times-circle"
				style		= "cursor:pointer"
				ng-click	= "recipient.removeFrom(conversation)"
			>
			</i> 
			{{$last? '' : ','}}
		</span> 				

		<!-- should be a modal here!-->
		<cm-contacts-list ng-show ="show_contacts"></cm-contacts-list>

	</div>

	<div>
		<input type ="text" ng-model="passphrase" cm-passphrase>

		<i
			class	 =	"fa fa-key"
			style	 =	"cursor: pointer"
			ng-click =	"generatePassphrase()"
		>
		</i>

		<i
			class	 =	"fa fa-circle"
			style	 =	"color: {{passphrase_valid ? 'green' : 'red'}}"			
		>
		</i>


		<br/>

		<i
			class	 = "fa fa-th-large"
			style	 = "cursor: pointer"
			ng-click = "show_captcha = !show_captcha"
			ng-hide	 = "new_conversation"
		>
		</i>				

		<br/>
		<div
			ng-show = "show_captcha"			
		>
			<i class="fa fa-refresh" style ="cursor:pointer" ng-click="refreshCaptcha()"></i>
			<button ng-click = "requestCaptcha()"> {{"CONVERSATION.LABEL.REQUEST_CAPTCHA" | cmTranslate}}</button>
			<button ng-click = "sendCaptcha()"> {{"CONVERSATION.LABEL.SEND_CAPTCHA" | cmTranslate}}</button>
			<cm-captcha ></cm-captcha><br/>
			
			
		</div>

	</div>

	<div class="cm-messages">
		<!-- performance ?? -->
		{{'CONVERSATION.TAG.MESSAGES' |cmTranslate}}:
		<cm-message 
			ng-repeat		= "message in conversation.messages"
			cm-data 		= "message" 
		></cm-message>
	</div>
	<div>
		<textarea cm-message-input ng-model="my_message_text"></textarea>
	</div>
	<div class="cm-tools">
		Security:
		<cm-security></cm-security>
		<cm-captcha></cm-captcha>
	</div>
	<div>
		<cm-upload></cm-upload>
		<button ng-click="sendMessage()">{{"CONVERSATION.LABEL.SEND" | cmTranslate}}</button>
		<cm-emoticons></cm-emoticons>
	</div>
</section>