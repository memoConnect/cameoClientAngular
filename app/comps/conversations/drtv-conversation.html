<cm-conversation-controls></cm-conversation-controls>

<div id="conversation-top"></div>

<div ng-repeat="message in conversation.messages" cm-scroll-to="#conversation-bottom" cm-last-message>
    <cm-date-seperator ng-if="(compareDate(message.created,conversation.messages[$index - 1].created))">{{message.created | date:'dd.MM.yyyy'}}</cm-date-seperator>
    <cm-message cm-data="message"></cm-message>
</div>

<div id="conversation-bottom"></div>

<div class="answer clearfix" id="files-droparea">
    <cm-files ng-model="files" data-qa="attachments-btn">
        <i class="fa cm-plus"></i>
        <div cm-user-rights>
            <cm-file-choose cm-droparea="files-droparea"></cm-file-choose>
            <cm-files-preview></cm-files-preview>
        </div>
        <div class="webreader-uploading" cm-user-rights="showForGuest" ng-click="openFastRegister()"></div>
    </cm-files>

    <div class="message" data-qa="answer-ctn" cm-handle-fixxed>
        <textarea data-qa="input-answer" cm-resize-textarea cm-max-rows="4" ng-model="my_message_text"></textarea>
        <i class="fa cm-smile-negative with-cursor"></i>
        <div class="inputter"></div>
    </div>

    <i class="fa cm-post with-cursor {{conversation.getSafetyLevelClass('-wrap')}}" ng-class="{'is-disabled':isSending}" data-qa="btn-send-answer" ng-click="send()"></i>
</div>