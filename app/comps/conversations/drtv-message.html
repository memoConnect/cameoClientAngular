<article class="clearfix" ng-if="!textOnly">
    <div ng-if="!is_my_own_message" class="avatar cm-fl">
        <cm-avatar cm-data="message.from"></cm-avatar>
    </div>
    <div class="message {{ is_my_own_message ? 'right' : 'left'}} cm-fl">
        <span class="nose {{ is_my_own_message ? 'right' : 'left'}}"><i class="fa {{ is_my_own_message ? 'cm-nose-right' : 'cm-nose-left'}}"></i></span>

        <!--<img ng-if = "hasCaptcha" src ="{{hasCaptcha ? message.body :''}}" class="img-responsive img-rounded"/>-->
        <!--<pre ng-if = "captchaRequest">{{'CONVERSATION.TEXT.REQUEST_CAPTCHA' | cmTranslate}}</pre>-->
        <!--<cm-download
            ng-if          = "hasAsset" 
            cm-data        = "assetId"
            cm-passphrase  = "passphrase"
        >
            <button ng-click="download()">
                {{fileId}}<br/>
                {{fileName}} ({{fileSize | cmFileSize}}) <br/>
                <progress value="{{progress}}" max =""></progress>
                <br/>
                {{progress*100 | cmDigits : 2}}%
            </button>
        </cm-download>-->
        <!--<pre ng-if ="!(hasCaptcha || captchaRequest || hasAsset)" style ="text-align:left">{{ message.decryptedBody }}</pre>-->
        <span class="text" ng-if="useTruncate">{{ message.text | truncate : 5 }}</span>
        <span class="text">{{ message.text|| 'CONVERSATION.TEXT.ENCRYPTED' | cmTranslate }}</span>

        <cm-message-files ng-if="message.files"></cm-message-files>

        <div class="author" ng-if="!is_my_own_message" data-qa="message-author">
            <span class="from grey">{{ message.from.getDisplayName() }}</span>
        </div>

        <div class="assets clearfix">
            <span class="date green cm-fl">{{ message.created | date:'HH:mm'}}</span>
            <span class="envelope green cm-fl"><i class="fa cm-envelope-open"></i></span>
            <span class="security green cm-fl"><cm-safety-level level ="conversation.getSafetyLevel()"></cm-safety-level></span>
        </div>

    </div>
    <!--<footer>-->
        <!--<cm-attachments></cm-attachments> &lt;!&ndash;{{ message.created }}&ndash;&gt;-->
    <!--</footer>-->
</article>

{{textOnly ? message.text  : ''}}
