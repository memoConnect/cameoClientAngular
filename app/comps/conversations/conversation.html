<section>
	<div class="cm-tools">
		<i
			class	 = "fa fa-plus-square" 			
			style	 = "cursor:pointer"
			ng-click = "show_contacts = !show_contacts"
			ng-hide	 = "show_contacts"
		>
		</i>

		<i
			class	 = "fa fa-minus-square" 			
			style	 = "cursor:pointer"
			ng-click = "show_contacts = !show_contacts"
			ng-show	 = "show_contacts"
		>
		</i>


		{{'CONVERSATION.TAG.RECIPIENTS' |cmTranslate}}:

		<span ng-repeat = "recipient in conversation.recipients">
			{{recipient.displayName}}
			<i
				class		= "fa fa-times-circle"
				style		= "cursor:pointer"
				ng-click	= "recipient.removeFrom(conversation)"
			>
			</i> 
			{{$last? '' : ','}}
		</span> 				

		<!-- should be a modal here!-->
		<cm-contacts-list ng-show ="show_contacts"></cm-contacts-list>

	</div>
	<div>
		{{'CONVERSATION.TAG.SUBJECT' |cmTranslate}}:
		<input type="text" ng-model = "conversation.subject" ng-if ="new_conversation ">
		<span ng-if ="!new_conversation && conversation.subject "> {{conversation.subject}} </span>
	</div>

	<div>
		{{"CONVERSATION.TAG.PASSPHRASE"|cmTranslate}}:
		<input type ="{{revealPassword ? 'text' : 'password'}}" ng-model="passphrase" cm-passphrase>
		 

        <i
        	class	 = "fa"
        	style	 = "cursor:pointer" 
        	ng-class = "{'fa-eye':revealPassword,'fa-eye-slash': !revealPassword}"
        	ng-click = "revealPassword = !revealPassword"
        ></i>

		<i
			class	 =	"fa fa-key"
			style	 =	"cursor: pointer"
			ng-click =	"generatePassphrase()"
		></i>

		<i
			class	 =	"fa fa-circle"
			style	 =	"color: {{passphrase_valid ? 'green' : 'red'}}"			
		></i>


		<br/>

		<i
			class	 = "fa fa-th-large"
			style	 = "cursor: pointer"
			ng-click = "show_captcha = !show_captcha"
			ng-hide	 = "new_conversation"
		></i>				

		<br/>
		<div
			ng-show = "show_captcha"			
		>
			<cm-captcha ></cm-captcha><br/>
			<i class="fa fa-refresh" style ="cursor:pointer" ng-click="refreshCaptcha()"></i>
			<button ng-click = "requestCaptcha()"> {{"CONVERSATION.LABEL.REQUEST_CAPTCHA" | cmTranslate}}</button>
			<button ng-click = "sendCaptcha()"> {{"CONVERSATION.LABEL.SEND_CAPTCHA" | cmTranslate}}</button>
		</div>

	</div>

	<br/>

	<div class="cm-messages">
		<!-- performance ?? -->
		<h4>{{'CONVERSATION.TAG.MESSAGES' |cmTranslate}}:</h4>
		<cm-message 
			ng-repeat		= "message in conversation.messages"
			cm-data 		= "message" 
		></cm-message>
	</div>
	<div>
		<textarea cm-message-input ng-model="my_message_text"></textarea>
	</div>	
	<div>
		<cm-upload></cm-upload>
		<button ng-click="sendMessage()">{{"CONVERSATION.LABEL.SEND" | cmTranslate}}</button>
		<cm-emoticons></cm-emoticons>
	</div>
</section>